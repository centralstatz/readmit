<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Investigating a Hospital-Specific Report (HSR) • readmit</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Lexend-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Tomorrow-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Investigating a Hospital-Specific Report (HSR)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">readmit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/investigating-an-hsr.html">Investigating a Hospital-Specific Report (HSR)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="investigating-an-hsr_files/core-js-2.5.3/shim.min.js"></script><script src="investigating-an-hsr_files/react-18.2.0/react.min.js"></script><script src="investigating-an-hsr_files/react-18.2.0/react-dom.min.js"></script><script src="investigating-an-hsr_files/reactwidget-2.0.0/react-tools.js"></script><link href="investigating-an-hsr_files/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="investigating-an-hsr_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="investigating-an-hsr_files/reactable-0.4.5/reactable.css" rel="stylesheet">
<script src="investigating-an-hsr_files/reactable-binding-0.4.5/reactable.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Investigating a Hospital-Specific Report (HSR)</h1>
            <h3 data-toc-skip class="subtitle">Analysis strategies to
gain insight into HRRP program results.</h3>
            
      

      <div class="d-none name"><code>investigating-an-hsr.Rmd</code></div>
    </div>

    
    
<p><em><strong>Note</strong>: CMS changed the format of
Hospital-Specific Reports (HSRs) for FY2026 (see <a href="https://qualitynet.cms.gov/inpatient/hrrp/reports#tab2" class="external-link">here</a>).
The current HSR functions support Excel-based formats through FY2025.
However, analysis strategies are still relevant.</em></p>
<p>As part of the <a href="https://www.cms.gov/medicare/payment/prospective-payment-systems/acute-inpatient-pps/hospital-readmissions-reduction-program-hrrp" class="external-link">Hospital
Readmissions Reduction Program (HRRP)</a>, the <a href="https://www.cms.gov/" class="external-link">Centers for Medicare &amp; Medicaid Services
(CMS)</a> provides a detailed, annual program summary report (called the
<a href="https://qualitynet.cms.gov/inpatient/hrrp/reports" class="external-link">Hospital-Specific
Report (HSR)</a>) to hospitals that includes details on the penalty
calculation for the upcoming fiscal year, such as discharge-level data,
dually-eligible discharge lists, cohort-level rollup, and the penalty
amount. There is a defined <a href="https://qualitynet.cms.gov/inpatient/hrrp/resources#tab1:~:text=FY%202026%20Hospital%20Readmissions%20Reduction%20Program%20Key%20Dates%20(08/11/25)" class="external-link">review
and correction period</a> in which hospitals can use these reports to
ensure the penalty being enforced by CMS is accurate. It occurs
approximately 1 month before the new fiscal year, thus it is a
time-critical event (see historical date ranges below for reference with
the built-in package datasets):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract date ranges</span></span>
<span><span class="fu">readmit</span><span class="fu">::</span><span class="va"><a href="../reference/hrrp_keydates.html">hrrp_keydates</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">ProgramYear</span>,</span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"^(Payment|Review)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 5</span></span></span>
<span><span class="co">#&gt;   ProgramYear PaymentStartDate PaymentEndDate ReviewStartDate ReviewEndDate</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>        <span style="text-decoration: underline;">2</span>027 2026-10-01       2027-09-30     <span style="color: #BB0000;">NA</span>              <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>        <span style="text-decoration: underline;">2</span>026 2025-10-01       2026-09-30     2025-08-12      2025-09-10   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>        <span style="text-decoration: underline;">2</span>025 2024-10-01       2025-09-30     2024-08-12      2024-09-10   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>        <span style="text-decoration: underline;">2</span>024 2023-10-01       2024-09-30     2023-08-08      2023-09-07   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>        <span style="text-decoration: underline;">2</span>023 2022-10-01       2023-09-30     2022-08-08      2022-09-07   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>        <span style="text-decoration: underline;">2</span>022 2021-10-01       2022-09-30     2021-08-09      2021-09-08   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>        <span style="text-decoration: underline;">2</span>021 2020-10-01       2021-09-30     2020-08-10      2020-09-09   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>        <span style="text-decoration: underline;">2</span>020 2019-10-01       2020-09-30     2019-08-09      2019-09-09   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>        <span style="text-decoration: underline;">2</span>019 2018-10-01       2019-09-30     2018-08-06      2018-09-05</span></span></code></pre></div>
<p>The report file itself (through FY2025) is a large, multi-tab
Microsoft Excel document where the structured part of the data is
ambiguously placed throughout, thus we need tools to parse it out into a
usable format. That is what some functions in the <code>readmit</code>
package are for. In this article, we go through the tools that are
available, what they do, and then provide some strategies/approaches for
how hospitals can use these tools to analyze their own HSR’s to gain
deeper insight into HRRP results and readmissions more broadly.</p>
<div class="section level2">
<h2 id="the-toolbox">The Toolbox<a class="anchor" aria-label="anchor" href="#the-toolbox"></a>
</h2>
<p>First, we’ll start by taking a look at what relevant functions are
available to us, what they do, and how to use them. For our purposes,
these are all of the functions prefixed like <code>hsr_*</code>. We’ll
do this roughly in order of how the report is laid out, and how the HRRP
results roll up.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://centralstatz.github.io/readmit/">readmit</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="mock-reports">0. Mock Reports<a class="anchor" aria-label="anchor" href="#mock-reports"></a>
</h3>
<p>As the developer of this package, I don’t have access to hospitals’
actual HSR’s, as they contain senstivie patient information (i.e., <a href="https://cphs.berkeley.edu/hipaa/hipaa18.html" class="external-link">PHI</a>) and thus
are not publicly available. So what we have to work with are
<em>mock</em> reports that <a href="https://qualitynet.cms.gov/inpatient/hrrp/reports#tab3" class="external-link">CMS
provides</a> to the public that are meant to mimick the format a
hospital can expect their report to be in. It just includes fake
data.</p>
<p><em><strong>Note</strong>: CMS changed the format of
Hospital-Specific Reports (HSRs) for FY2026 (see <a href="https://qualitynet.cms.gov/inpatient/hrrp/reports#tab2" class="external-link">here</a>).
The current HSR functions support Excel-based formats through
FY2025.</em></p>
<p>Nevertheless, these provide a useful playground to analyze the
mechanics of the program. We’ll start by finding a report with the
<code><a href="../reference/hsr_mock_reports.html">hsr_mock_reports()</a></code> function:</p>
<ul>
<li>Using no arguments lists the various mock files included in the
package</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hsr_mock_reports.html">hsr_mock_reports</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "FY2019_HRRP_MockHSR.xlsx" "FY2020_HRRP_MockHSR.xlsx"</span></span>
<span><span class="co">#&gt; [3] "FY2021_HRRP_MockHSR.xlsx" "FY2022_HRRP_MockHSR.xlsx"</span></span>
<span><span class="co">#&gt; [5] "FY2023_HRRP_MockHSR.xlsx" "FY2024_HRRP_MockHSR.xlsx"</span></span>
<span><span class="co">#&gt; [7] "FY2025_HRRP_MockHSR.xlsx"</span></span></code></pre></div>
<ul>
<li>Entering one of the listed file names will return the complete path
to the file in the packages location on your computer</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_report</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hsr_mock_reports.html">hsr_mock_reports</a></span><span class="op">(</span><span class="st">"FY2025_HRRP_MockHSR.xlsx"</span><span class="op">)</span></span>
<span><span class="va">my_report</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/readmit/extdata/FY2025_HRRP_MockHSR.xlsx"</span></span></code></pre></div>
<p>Now we can use that HSR path with other package functions. Of course,
you would just point to your own HSR when analyzing your hospital’s
reports.</p>
</div>
<div class="section level3">
<h3 id="programsummary">1. Program Summary<a class="anchor" aria-label="anchor" href="#programsummary"></a>
</h3>
<p>We’ll start with high level program results. Ultimately, all of the
moving parts in the HRRP roll up into a single number: the penalty
amount applied to your hospital. This is typically the first table in
your report. We can parse it out of the report with the
<code><a href="../reference/hsr_payment_summary.html">hsr_payment_summary()</a></code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_payment_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hsr_payment_summary.html">hsr_payment_summary</a></span><span class="op">(</span><span class="va">my_report</span><span class="op">)</span></span>
<span><span class="va">my_payment_summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">#&gt;   Number of Dually Eligible Stays…¹ Total Number of Stay…² `Dual Proportion [c]`</span></span>
<span><span class="co">#&gt;                               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                               186                    856                 0.217</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated names: ¹​`Number of Dually Eligible Stays (Numerator) [a]`,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ²​`Total Number of Stays(Denominator) [b]`</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: `Peer Group Assignment [d]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Neutrality Modifier [e]` &lt;dbl&gt;, `Payment Reduction Percentage [f]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Payment Adjustment Factor [g]` &lt;dbl&gt;</span></span></span></code></pre></div>
<p>We now have this information in a data frame that we can manipulate
as needed:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_payment_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 2</span></span></span>
<span><span class="co">#&gt;   name                                               value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Number of Dually Eligible Stays (Numerator) [a] 186     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Total Number of Stays(Denominator) [b]          856     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Dual Proportion [c]                               0.217 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Peer Group Assignment [d]                         3     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Neutrality Modifier [e]                           0.965 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Payment Reduction Percentage [f]                  0.000<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> Payment Adjustment Factor [g]                     0.999</span></span></code></pre></div>
<p>There are also helper functions to extract specific components from
this table.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hsr_payment_summary.html">hsr_payment_penalty</a></span><span class="op">(</span><span class="va">my_report</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7e-04</span></span>
<span><span class="fu"><a href="../reference/hsr_payment_summary.html">hsr_dual_proportion</a></span><span class="op">(</span><span class="va">my_report</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.2172897</span></span>
<span><span class="fu"><a href="../reference/hsr_payment_summary.html">hsr_peer_group</a></span><span class="op">(</span><span class="va">my_report</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>See <code><a href="../reference/hsr_payment_summary.html">?hsr_payment_summary</a></code> for all of them.</p>
</div>
<div class="section level3">
<h3 id="cohortsummary">2. Cohort Summary<a class="anchor" aria-label="anchor" href="#cohortsummary"></a>
</h3>
<p>The overall payment penalty a hospital receives is a weighted average
of penalities applied to the individual cohorts. These details are
typically in the second table (tab) of the HSR, which we can import with
<code><a href="../reference/hsr_cohort_summary.html">hsr_cohort_summary()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hsr_cohort_summary.html">hsr_cohort_summary</a></span><span class="op">(</span><span class="va">my_report</span><span class="op">)</span></span>
<span><span class="va">cohort_summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   `Measure [a]` `Number of Eligible Discharges [b]` Number of Readmissions Amo…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AMI                                             2                            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> COPD                                           18                            3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> HF                                             25                            2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Pneumonia                                      32                            5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> CABG                                           <span style="color: #BB0000;">NA</span>                           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> THA/TKA                                        45                            0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`Number of Readmissions Among Eligible Discharges [c]`</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: `Predicted Readmission Rate [d]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Expected Readmission Rate [e]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Excess Readmission Ratio (ERR) [f]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Peer Group Median ERR [g]` &lt;dbl&gt;, `Penalty Indicator (Yes/No) [h]` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Ratio of DRG Payments Per Measure to Total Payments [i]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `National Observed Readmission Rate [j]` &lt;dbl&gt;</span></span></span></code></pre></div>
<p>We can then, for example, reconcile the overall penalty amount based
on what is in this table:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_summary</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co"># Filter to cohorts with a penalty</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Penalty Indicator (Yes/No) [h]`</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Compute the contribution of each penalized cohort</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Contribution <span class="op">=</span> </span>
<span>      <span class="va">`Ratio of DRG Payments Per Measure to Total Payments [i]`</span> <span class="op">*</span></span>
<span>      <span class="op">(</span></span>
<span>        <span class="va">`Excess Readmission Ratio (ERR) [f]`</span> <span class="op">-</span> </span>
<span>          <span class="va">`Peer Group Median ERR [g]`</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Roll up into final calculation</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    Penalty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Contribution</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="../reference/hsr_payment_summary.html">hsr_neutrality_modifier</a></span><span class="op">(</span><span class="va">my_report</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 1</span></span></span>
<span><span class="co">#&gt;    Penalty</span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0.000<span style="text-decoration: underline;">746</span></span></span></code></pre></div>
<p>What we did here was:</p>
<ol style="list-style-type: decimal">
<li>Find cohorts who received a penalty <em>who were eligible</em>
<ul>
<li>A cohort must have at least 25 discharges to be eligible</li>
<li>Then, the excess readmission ratio (ERR) must be greater than the
assigned peer group’s median ERR</li>
</ul>
</li>
<li>Find the difference between the hospital’s ERR compared to the peer
group median ERR</li>
<li>Multiply that by the ratio of DRG payments for that cohort
<ul>
<li>This is a measure of the volume of patients with this condition are
treated at the hospital</li>
</ul>
</li>
<li>Sum those contributions over each cohort</li>
<li>Multiply that by the neutrality modifier in the
<code><a href="../reference/hsr_payment_summary.html">hsr_payment_summary()</a></code> table</li>
</ol>
<p>That’s how the penalty is computed, from cohort summary level.</p>
</div>
<div class="section level3">
<h3 id="discharges">3. Discharges<a class="anchor" aria-label="anchor" href="#discharges"></a>
</h3>
<p><em>Note: Because we are using mock reports, the dates in these files
are erroneous and thus R doesn’t interpret them as dates. However, your
hospital report has real dates and thus R should automatically parse
them as such.</em></p>
<p>The HSR also contains discharge-level data on the individual patients
that actually contributed to the program. There is a separate table/tab
for each of the cohorts. We can use the <code><a href="../reference/hsr_discharges.html">hsr_discharges()</a></code>
function to import them for a specified cohort:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span><span class="va">my_report</span>, <span class="st">"COPD"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 17</span></span></span>
<span><span class="co">#&gt;    `ID Number` MBI         `Medical Record Number` `Beneficiary DOB`</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: `Admission Date of Index Stay` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Discharge Date of Index Stay` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Cohort Inclusion/Exclusion Indicator` &lt;chr&gt;, `Index Stay (Yes/No)` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Principal Discharge Diagnosis of Index Stay` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Discharge Destination` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Unplanned Readmission within 30 Days (Yes/No) [a]` &lt;chr&gt;, …</span></span></span></code></pre></div>
<p>We get some patient identifying information, including the specific
dates associated with the index and readmission hospitalizations,
whether or not the readmission occurred at the same hospital, diagnosis
codes, etc., which is all very valuable information that we can explore
to gain insights from (and what we’ll do <a href="#analysisstrategies">later</a>).</p>
<p>There are also options available in the function to refine the
result:</p>
<div class="section level4">
<h4 id="eligible-cases">Eligible Cases<a class="anchor" aria-label="anchor" href="#eligible-cases"></a>
</h4>
<p>The <code>eligible_only</code> argument can be used to only included
discharges that were actually included in HRRP evaluation:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="va">my_report</span>, </span>
<span>  cohort <span class="op">=</span> <span class="st">"COPD"</span>,</span>
<span>  eligible_only <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 17</span></span></span>
<span><span class="co">#&gt;    `ID Number` MBI         `Medical Record Number` `Beneficiary DOB`</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>          11 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>          12 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>          13 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>          14 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>          15 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>          16 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>          17 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>          18 9AA9AA9AA99 99999A                  99/99/9999       </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: `Admission Date of Index Stay` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Discharge Date of Index Stay` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Cohort Inclusion/Exclusion Indicator` &lt;chr&gt;, `Index Stay (Yes/No)` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Principal Discharge Diagnosis of Index Stay` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Discharge Destination` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Unplanned Readmission within 30 Days (Yes/No) [a]` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Planned Readmission within 30 Days (Yes/No)` &lt;chr&gt;, …</span></span></span></code></pre></div>
<p>Notice that this row count matches what was reported as the COPD
denominator in the <code>cohort_summary</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_summary</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">`Measure [a]`</span> <span class="op">==</span> <span class="st">"COPD"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">`Number of Eligible Discharges [b]`</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 18</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="risk-factors">Risk Factors<a class="anchor" aria-label="anchor" href="#risk-factors"></a>
</h4>
<p>Also included in these tables are the indicators of risk factors that
are used in the statistical models to estimate individual adjusted
readmission risks. We can use the <code>risk_factors</code> argument to
extract those for each patient:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="va">my_report</span>, </span>
<span>  cohort <span class="op">=</span> <span class="st">"COPD"</span>,</span>
<span>  eligible_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  risk_factors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  discharge_phi <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 42</span></span></span>
<span><span class="co">#&gt;    `ID Number` `Years Over 65 (continuous)` `History of Mechanical Ventilation`</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1                            5                                   1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2                            8                                   1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3                           23                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4                           15                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5                            7                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6                            1                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7                           12                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8                           18                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9                            6                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10                           11                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>          11                           15                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>          12                           13                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>          13                            5                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>          14                           12                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>          15                           12                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>          16                           24                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>          17                           12                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>          18                           11                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 39 more variables: `Sleep-Disordered Breathing` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `History of COVID-19` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Lung and Other Severe Cancers` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Other Digestive and Urinary Neoplasms` &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p>This data can then be explored further to understand risk factor
prevalence and how that relates to model weights, etc. (again, covered
<a href="#analysisstrategies">later</a>). Notice the
<code>discharge_phi</code> argument was used to prevent the date
information from being returned.</p>
</div>
</div>
<div class="section level3">
<h3 id="modelcoefficients">4. Model Coefficients<a class="anchor" aria-label="anchor" href="#modelcoefficients"></a>
</h3>
<p>The ERR is calculated based on an aggregated roll up of individual
adjusted readmission risks derived from a random-intercept logistic
regression model. The first row in the discharge table contains the
coefficients for this model. We can use the
<code><a href="../reference/hsr_coefficients.html">hsr_coefficients()</a></code> function to extract them:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">copd_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hsr_coefficients.html">hsr_coefficients</a></span><span class="op">(</span><span class="va">my_report</span>, <span class="st">"COPD"</span><span class="op">)</span></span>
<span><span class="va">copd_model</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 43 × 2</span></span></span>
<span><span class="co">#&gt;    Factor                                                                  Value</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Years Over 65 (continuous)                                           -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">50</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> History of Mechanical Ventilation                                     0.293  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Sleep-Disordered Breathing                                           -<span style="color: #BB0000;">0.033</span><span style="color: #BB0000; text-decoration: underline;">9</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> History of COVID-19                                                  -<span style="color: #BB0000;">0.020</span><span style="color: #BB0000; text-decoration: underline;">0</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Severe Infection; Other Infectious Diseases                           0.038<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Metastatic Cancer and Acute Leukemia                                  0.201  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Lung and Other Severe Cancers                                         0.156  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, C… -<span style="color: #BB0000;">0.003</span><span style="color: #BB0000; text-decoration: underline;">43</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Other Digestive and Urinary Neoplasms                                -<span style="color: #BB0000;">0.079</span><span style="color: #BB0000; text-decoration: underline;">2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Diabetes Mellitus (DM) or DM Complications                            0.089<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 33 more rows</span></span></span></code></pre></div>
<p>This allows us to do things like assess the relative contribution of
risk factors to the estimated readmission rates or use the risk factor
dataset above to compute individual level readmission risks.</p>
<div class="section level4">
<h4 id="intercept-terms">Intercept Terms<a class="anchor" aria-label="anchor" href="#intercept-terms"></a>
</h4>
<p>The <em>predicted</em> and <em>expected</em> readmission rates only
differ in the intercept terms applied to the prediction (thus it is a
constant shift for all patients). We can see these at the end of this
data frame:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">copd_model</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   Factor                                           Value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Renal Failure                                   0.160 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Decubitus Ulcer or Chronic Skin Ulcer           0.072<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Cellulitis, Local Skin Infection                0.041<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Vertebral Fractures Without Spinal Cord Injury  0.082<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> HOSP_EFFECT                                    -<span style="color: #BB0000;">2.53</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> AVG_EFFECT                                     -<span style="color: #BB0000;">2.53</span></span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="readmission-risks">5. Readmission Risks<a class="anchor" aria-label="anchor" href="#readmission-risks"></a>
</h3>
<p>We could take the risk factor output from
<code><a href="../reference/hsr_discharges.html">hsr_discharges()</a></code> combined with the coefficients from
<code><a href="../reference/hsr_coefficients.html">hsr_coefficients()</a></code> and reconcile each patient’s
<em>predicted</em> and <em>expected</em> readmission risk. But the
<code><a href="../reference/hsr_readmission_risks.html">hsr_readmission_risks()</a></code> function can do all of that for
us:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">risks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hsr_readmission_risks.html">hsr_readmission_risks</a></span><span class="op">(</span><span class="va">my_report</span>, <span class="st">"COPD"</span><span class="op">)</span></span>
<span><span class="va">risks</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 3</span></span></span>
<span><span class="co">#&gt;    `ID Number` Predicted Expected</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1    0.260    0.260 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2    0.266    0.266 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3    0.227    0.227 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4    0.099<span style="text-decoration: underline;">0</span>   0.098<span style="text-decoration: underline;">9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5    0.093<span style="text-decoration: underline;">5</span>   0.093<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6    0.130    0.130 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7    0.156    0.156 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8    0.190    0.190 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9    0.084<span style="text-decoration: underline;">2</span>   0.084<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10    0.100    0.100 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>          11    0.129    0.129 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>          12    0.111    0.111 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>          13    0.350    0.349 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>          14    0.127    0.127 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>          15    0.158    0.158 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>          16    0.168    0.168 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>          17    0.118    0.118 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>          18    0.210    0.210</span></span></code></pre></div>
<p>This just takes a weighted-sum of the risk factors and coefficients,
adds the corresponding intercept, and then maps it to a probability
through the logistic function.</p>
<p>The cohort-level <em>predicted</em> and <em>expected</em> readmission
rates are just the averages of these columns across all eligible
patients:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">risks</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    Discharges <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    Predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Predicted</span><span class="op">)</span>,</span>
<span>    Expected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Expected</span><span class="op">)</span>,</span>
<span>    ERR <span class="op">=</span> <span class="va">Predicted</span> <span class="op">/</span> <span class="va">Expected</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   Discharges Predicted Expected   ERR</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         18     0.165    0.165  1.00</span></span></code></pre></div>
<p>Again, looking at our cohort summary, we can see these match:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_summary</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">`Measure [a]`</span> <span class="op">==</span> <span class="st">"COPD"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    Discharges <span class="op">=</span> <span class="va">`Number of Eligible Discharges [b]`</span>,</span>
<span>    Predicted <span class="op">=</span> <span class="va">`Predicted Readmission Rate [d]`</span>,</span>
<span>    Expected <span class="op">=</span> <span class="va">`Expected Readmission Rate [e]`</span>,</span>
<span>    ERR <span class="op">=</span> <span class="va">`Excess Readmission Ratio (ERR) [f]`</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   Discharges Predicted Expected   ERR</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         18     0.165    0.165  1.00</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dual-stays">6. Dual Stays<a class="anchor" aria-label="anchor" href="#dual-stays"></a>
</h3>
<p>CMS puts hospitals into peer groups based on the relative proportion
of Medicare patients who are also eligible for Medicaid. This is a
measure of socioeconomic status for the hospital population so hospitals
are being compared only against other hospitals that are similar (in
this regard). These aggregated quantities were found in
<code><a href="../reference/hsr_payment_summary.html">hsr_payment_summary()</a></code> result:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_payment_summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 7</span></span></span>
<span><span class="co">#&gt;   Number of Dually Eligible Stays…¹ Total Number of Stay…² `Dual Proportion [c]`</span></span>
<span><span class="co">#&gt;                               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                               186                    856                 0.217</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated names: ¹​`Number of Dually Eligible Stays (Numerator) [a]`,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ²​`Total Number of Stays(Denominator) [b]`</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: `Peer Group Assignment [d]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Neutrality Modifier [e]` &lt;dbl&gt;, `Payment Reduction Percentage [f]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Payment Adjustment Factor [g]` &lt;dbl&gt;</span></span></span></code></pre></div>
<p>The <code><a href="../reference/hsr_dual_stays.html">hsr_dual_stays()</a></code> function extracts the
discharge-level data corresponding to the numerator of the ratio:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hsr_dual_stays.html">hsr_dual_stays</a></span><span class="op">(</span><span class="va">my_report</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 186 × 6</span></span></span>
<span><span class="co">#&gt;    `ID Number` MBI         `Beneficiary DOB` `Admission Date` `Discharge Date`</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10 9AA9AA9AA99 99/99/9999        99/99/9999       99/99/9999      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 176 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: `Claim Type` &lt;chr&gt;</span></span></span></code></pre></div>
<p>We can see that the row count of this discharge level data matches
the first number in the preceding table.</p>
</div>
</div>
<div class="section level2">
<h2 id="analysisstrategies">Analysis Strategies<a class="anchor" aria-label="anchor" href="#analysisstrategies"></a>
</h2>
<p>In this section we’ll go through a collection data analyses that can
be conducted, using functions in <code>readmit</code> as support, to
validate HSR calculations and/or to gain deeper insights into HRRP
results.</p>
<div class="section level3">
<h3 id="validating-the-penalty-calculation">1. Validating the Penalty Calculation<a class="anchor" aria-label="anchor" href="#validating-the-penalty-calculation"></a>
</h3>
<p>We <a href="#cohortsummary">previously calculated</a> the payment
penalty starting from the cohort-level results. However, as an initial
validation step, it is important to go through the mechanics of
reconciling the penalty calculation from the discharge-level data to
ensure comprehension of how it works.</p>
<p><em>Note: We’ll go the slower, more tedious way to do this in the
steps below in order to capture all intermediate details for
understanding, but will callout where certain steps can be more
efficient.</em></p>
<p>Let’s extract the <code>cohort</code> strings we need to plug into
various function arguments:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohorts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">hrrp_cohort_inclusion</span><span class="op">)</span>, <span class="st">"ProgramYear"</span><span class="op">)</span></span>
<span><span class="va">cohorts</span></span>
<span><span class="co">#&gt; [1] "AMI"  "COPD" "HF"   "PN"   "CABG" "HK"</span></span></code></pre></div>
<div class="section level4">
<h4 id="i--extract-discharges">i. Extract Discharges<a class="anchor" aria-label="anchor" href="#i--extract-discharges"></a>
</h4>
<p>The first thing we need to is extract the set of discharges (i.e.,
the <em>denominator</em>) that contribute to program for each cohort. To
do this, we’ll iterate through the different cohorts and sequentially
use the <code><a href="../reference/hsr_discharges.html">hsr_discharges()</a></code> function to get the row
identifiers that should be included:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eligible_discharges</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">cohorts</span>, <span class="st">"CABG"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Iterate each cohort</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span></span>
<span></span>
<span>      <span class="co"># Import eligible discharges</span></span>
<span>      <span class="op">~</span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span></span>
<span>        file <span class="op">=</span> <span class="va">my_report</span>,</span>
<span>        cohort <span class="op">=</span> <span class="va">.x</span>,</span>
<span>        eligible_only <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>      <span class="co"># Keep the row identifiers</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">`ID Number`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>      <span class="co"># Add cohort identifier</span></span>
<span>      <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Cohort <span class="op">=</span> <span class="va">.x</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">eligible_discharges</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 122 × 2</span></span></span>
<span><span class="co">#&gt;    `ID Number` Cohort</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           1 COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           2 COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           3 COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           4 COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           5 COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           6 COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           7 COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           8 COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 112 more rows</span></span></span></code></pre></div>
<p>We can check the counts of these:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">eligible_discharges</span><span class="op">$</span><span class="va">Cohort</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  AMI COPD   HF   HK   PN </span></span>
<span><span class="co">#&gt;    2   18   25   45   32</span></span></code></pre></div>
<p>You can validate that we obtained the correct counts by looking at
the <a href="#cohortsummary">cohort summary</a> we previously
created.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_summary</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 10</span></span></span>
<span><span class="co">#&gt;   `Measure [a]` `Number of Eligible Discharges [b]` Number of Readmissions Amo…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AMI                                             2                            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> COPD                                           18                            3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> HF                                             25                            2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Pneumonia                                      32                            5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> CABG                                           <span style="color: #BB0000;">NA</span>                           <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> THA/TKA                                        45                            0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`Number of Readmissions Among Eligible Discharges [c]`</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7 more variables: `Predicted Readmission Rate [d]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Expected Readmission Rate [e]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Excess Readmission Ratio (ERR) [f]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Peer Group Median ERR [g]` &lt;dbl&gt;, `Penalty Indicator (Yes/No) [h]` &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Ratio of DRG Payments Per Measure to Total Payments [i]` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `National Observed Readmission Rate [j]` &lt;dbl&gt;</span></span></span></code></pre></div>
<p>One caveat was that we already knew there weren’t any
<code>CABG</code> discharges (via the <code>NA</code> in the
<code>cohort_summary</code> table), so we pre-excluded this from our
cohort list we iterated through (as it would have caused an error
otherwise).</p>
</div>
<div class="section level4">
<h4 id="riskfactors">ii. Extract Risk Factors<a class="anchor" aria-label="anchor" href="#riskfactors"></a>
</h4>
<p>Next we need to extract the sets of risk factors for each cohort that
go into the readmission risk model. We can again do this by iterating
through the <code>cohort</code> list with <code>hsr_discharges</code>,
but extracting the risk factors as well with
<code>risk_factors=TRUE</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">cohorts</span>, <span class="st">"CABG"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Iterate each cohort</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span></span>
<span>      <span class="co"># Import eligible discharges</span></span>
<span>      <span class="op">~</span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span></span>
<span>        file <span class="op">=</span> <span class="va">my_report</span>,</span>
<span>        cohort <span class="op">=</span> <span class="va">.x</span>,</span>
<span>        risk_factors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        discharge_phi <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 33</span></span></span>
<span><span class="co">#&gt;   `ID Number` `Years Over 65 (continuous)`  Male Anterior Myocardial Infarctio…¹</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>           1                           31     1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>           2                           27     1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`Anterior Myocardial Infarction `</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 29 more variables: `Non-Anterior Location of Myocardial Infarction` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `History of Coronary Artery Bypass Graft (CABG) Surgery` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `History of Percutaneous Transluminal Coronary Angioplasty (PTCA)` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `History of COVID-19` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;, Cancer &lt;dbl&gt;, …</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 21 × 42</span></span></span>
<span><span class="co">#&gt;    `ID Number` `Years Over 65 (continuous)` `History of Mechanical Ventilation`</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1                            5                                   1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2                            8                                   1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3                           23                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4                           15                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5                            7                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6                            1                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7                           12                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8                           18                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9                            6                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10                           11                                   0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 39 more variables: `Sleep-Disordered Breathing` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `History of COVID-19` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Lung and Other Severe Cancers` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms` &lt;dbl&gt;, …</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 × 39</span></span></span>
<span><span class="co">#&gt;    `ID Number` `Years Over 65 (continuous)`  Male History of Coronary Artery B…¹</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1                            8     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2                           25     1                              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3                            9     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4                            9     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5                           30     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6                           13     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7                           12     1                              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8                            7     1                              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9                           25     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10                           22     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`History of Coronary Artery Bypass Graft (CABG) Surgery`</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 35 more variables: `History of COVID-19` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;, Cancer &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Diabetes Mellitus (DM) or DM Complications` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Protein-Calorie Malnutrition` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance` &lt;dbl&gt;, …</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 45 × 43</span></span></span>
<span><span class="co">#&gt;    `ID Number` `Years Over 65 (continuous)`  Male History of Coronary Artery B…¹</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1                           13     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2                           16     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3                            6     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4                           14     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5                           16     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6                           18     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7                           15     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8                           13     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9                            9     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10                            4     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 35 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`History of Coronary Artery Bypass Graft (CABG) Surgery`</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 39 more variables: `History of COVID-19` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Septicemia, Sepsis, Systemic Inflammatory Response Syndrome/Shock` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Lung and Other Severe Cancers` &lt;dbl&gt;, `Lymphoma; Other Cancers` &lt;dbl&gt;, …</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 51 × 35</span></span></span>
<span><span class="co">#&gt;    `ID Number` `Years Over 65 (continuous)`  Male Index Admissions with an Ele…¹</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1                            1     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2                            7     1                              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3                            1     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4                            6     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5                            1     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6                           11     1                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7                           14     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8                           16     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9                            1     0                              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10                           16     0                              1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 41 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`Index Admissions with an Elective THA Procedure`</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 31 more variables: `Number of Procedures (two vs. one)` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Other Congenital Deformity of Hip (Joint)` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Post Traumatic Osteoarthritis` &lt;dbl&gt;, `History of COVID-19` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;, Cancer &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p>Notice that we get the risk factors for each cohort, but all of the
columns are different since each cohort has a different model. So one
thing we can do is pivot the data with
<code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">tidyr::pivot_longer()</a></code> to make a long and narrow data frame
so that it can all be binded together.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">risk_factors</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">cohorts</span>, <span class="st">"CABG"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>      <span class="co"># Iterate each cohort</span></span>
<span>      <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span></span>
<span></span>
<span>        <span class="co"># Import eligible discharges</span></span>
<span>        <span class="op">~</span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span></span>
<span>          file <span class="op">=</span> <span class="va">my_report</span>,</span>
<span>          cohort <span class="op">=</span> <span class="va">.x</span>,</span>
<span>          risk_factors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          discharge_phi <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        </span>
<span>        <span class="co"># Send risk factors down the rows</span></span>
<span>        <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>          cols <span class="op">=</span> <span class="op">-</span><span class="va">`ID Number`</span>,</span>
<span>          names_to <span class="op">=</span> <span class="st">"Factor"</span>,</span>
<span>          values_to <span class="op">=</span> <span class="st">"Value"</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        </span>
<span>        <span class="co"># Indicate cohort</span></span>
<span>        <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Cohort <span class="op">=</span> <span class="va">.x</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span><span class="va">risk_factors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5,689 × 4</span></span></span>
<span><span class="co">#&gt;    `ID Number` Factor                                               Value Cohort</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 <span style="color: #949494;">"</span>Years Over 65 (continuous)<span style="color: #949494;">"</span>                            31 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           1 <span style="color: #949494;">"</span>Male<span style="color: #949494;">"</span>                                                   1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           1 <span style="color: #949494;">"</span>Anterior Myocardial Infarction <span style="color: #949494;">"</span>                        0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           1 <span style="color: #949494;">"</span>Non-Anterior Location of Myocardial Infarction<span style="color: #949494;">"</span>         0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           1 <span style="color: #949494;">"</span>History of Coronary Artery Bypass Graft (CABG) Sur…     1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           1 <span style="color: #949494;">"</span>History of Percutaneous Transluminal Coronary Angi…     0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           1 <span style="color: #949494;">"</span>History of COVID-19<span style="color: #949494;">"</span>                                    0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           1 <span style="color: #949494;">"</span>Severe Infection; Other Infectious Diseases<span style="color: #949494;">"</span>            1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           1 <span style="color: #949494;">"</span>Metastatic Cancer and Acute Leukemia<span style="color: #949494;">"</span>                   0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           1 <span style="color: #949494;">"</span>Cancer<span style="color: #949494;">"</span>                                                 0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5,679 more rows</span></span></span></code></pre></div>
<p>We can then merge these (using <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">dplyr::inner_join()</a></code>) with
the eligilble discharges we previously identified to get the set of risk
factors for each eligible discharge:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">risk_factors</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">risk_factors</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Join to get eligible only</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> <span class="va">eligible_discharges</span>,</span>
<span>      by <span class="op">=</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>          <span class="st">"ID Number"</span>,</span>
<span>          <span class="st">"Cohort"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">risk_factors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,626 × 4</span></span></span>
<span><span class="co">#&gt;    `ID Number` Factor                                               Value Cohort</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 <span style="color: #949494;">"</span>Years Over 65 (continuous)<span style="color: #949494;">"</span>                            31 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           1 <span style="color: #949494;">"</span>Male<span style="color: #949494;">"</span>                                                   1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           1 <span style="color: #949494;">"</span>Anterior Myocardial Infarction <span style="color: #949494;">"</span>                        0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           1 <span style="color: #949494;">"</span>Non-Anterior Location of Myocardial Infarction<span style="color: #949494;">"</span>         0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           1 <span style="color: #949494;">"</span>History of Coronary Artery Bypass Graft (CABG) Sur…     1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           1 <span style="color: #949494;">"</span>History of Percutaneous Transluminal Coronary Angi…     0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           1 <span style="color: #949494;">"</span>History of COVID-19<span style="color: #949494;">"</span>                                    0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           1 <span style="color: #949494;">"</span>Severe Infection; Other Infectious Diseases<span style="color: #949494;">"</span>            1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           1 <span style="color: #949494;">"</span>Metastatic Cancer and Acute Leukemia<span style="color: #949494;">"</span>                   0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           1 <span style="color: #949494;">"</span>Cancer<span style="color: #949494;">"</span>                                                 0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,616 more rows</span></span></span></code></pre></div>
<p>Of course, we didn’t <em>have</em> to do this step separately from
step (i), as we could have just used the <code>eligible_only</code>
argument simultaneously, and ended up in the same place.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">risk_factors</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">cohorts</span>, <span class="st">"CABG"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>      <span class="co"># Iterate each cohort</span></span>
<span>      <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span></span>
<span></span>
<span>        <span class="co"># Import eligible discharges</span></span>
<span>        <span class="op">~</span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span></span>
<span>          file <span class="op">=</span> <span class="va">my_report</span>,</span>
<span>          cohort <span class="op">=</span> <span class="va">.x</span>,</span>
<span>          risk_factors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>          discharge_phi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          eligible_only <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        </span>
<span>        <span class="co"># Send risk factors down the rows</span></span>
<span>        <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>          cols <span class="op">=</span> <span class="op">-</span><span class="va">`ID Number`</span>,</span>
<span>          names_to <span class="op">=</span> <span class="st">"Factor"</span>,</span>
<span>          values_to <span class="op">=</span> <span class="st">"Value"</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        </span>
<span>        <span class="co"># Indicate cohort</span></span>
<span>        <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Cohort <span class="op">=</span> <span class="va">.x</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span><span class="va">risk_factors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,626 × 4</span></span></span>
<span><span class="co">#&gt;    `ID Number` Factor                                               Value Cohort</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 <span style="color: #949494;">"</span>Years Over 65 (continuous)<span style="color: #949494;">"</span>                            31 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           1 <span style="color: #949494;">"</span>Male<span style="color: #949494;">"</span>                                                   1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           1 <span style="color: #949494;">"</span>Anterior Myocardial Infarction <span style="color: #949494;">"</span>                        0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           1 <span style="color: #949494;">"</span>Non-Anterior Location of Myocardial Infarction<span style="color: #949494;">"</span>         0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           1 <span style="color: #949494;">"</span>History of Coronary Artery Bypass Graft (CABG) Sur…     1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           1 <span style="color: #949494;">"</span>History of Percutaneous Transluminal Coronary Angi…     0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           1 <span style="color: #949494;">"</span>History of COVID-19<span style="color: #949494;">"</span>                                    0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           1 <span style="color: #949494;">"</span>Severe Infection; Other Infectious Diseases<span style="color: #949494;">"</span>            1 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           1 <span style="color: #949494;">"</span>Metastatic Cancer and Acute Leukemia<span style="color: #949494;">"</span>                   0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           1 <span style="color: #949494;">"</span>Cancer<span style="color: #949494;">"</span>                                                 0 AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,616 more rows</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="individualreadmissionrisk">iii. Compute Individual Readmission Risks<a class="anchor" aria-label="anchor" href="#individualreadmissionrisk"></a>
</h4>
<p>The <em>predicted</em> and <em>expected</em> readmission rates are
computed for each discharge by plugging in each patient’s set of risk
factors into risk models developed by CMS. We can use the
<code><a href="../reference/hsr_coefficients.html">hsr_coefficients()</a></code> function to extract these:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_weights</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">cohorts</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co"># Iterate each cohort</span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span></span>
<span></span>
<span>    <span class="co"># Import eligible discharges</span></span>
<span>    <span class="op">~</span><span class="fu"><a href="../reference/hsr_coefficients.html">hsr_coefficients</a></span><span class="op">(</span></span>
<span>      file <span class="op">=</span> <span class="va">my_report</span>,</span>
<span>      cohort <span class="op">=</span> <span class="va">.x</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    </span>
<span>    <span class="co"># Indicate cohort</span></span>
<span>    <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Cohort <span class="op">=</span> <span class="va">.x</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">model_weights</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 225 × 3</span></span></span>
<span><span class="co">#&gt;    Factor                                                           Value Cohort</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span>Years Over 65 (continuous)<span style="color: #949494;">"</span>                                   0.007<span style="text-decoration: underline;">65</span> AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>Male<span style="color: #949494;">"</span>                                                        -<span style="color: #BB0000;">0.134</span>   AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>Anterior Myocardial Infarction <span style="color: #949494;">"</span>                              0.271   AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>Non-Anterior Location of Myocardial Infarction<span style="color: #949494;">"</span>               0.071<span style="text-decoration: underline;">2</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>History of Coronary Artery Bypass Graft (CABG) Surgery<span style="color: #949494;">"</span>       0.023<span style="text-decoration: underline;">3</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>History of Percutaneous Transluminal Coronary Angioplasty (… -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">8</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>History of COVID-19<span style="color: #949494;">"</span>                                         -<span style="color: #BB0000;">0.067</span><span style="color: #BB0000; text-decoration: underline;">6</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>Severe Infection; Other Infectious Diseases<span style="color: #949494;">"</span>                  0.083<span style="text-decoration: underline;">2</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>Metastatic Cancer and Acute Leukemia<span style="color: #949494;">"</span>                         0.226   AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>Cancer<span style="color: #949494;">"</span>                                                       0.044<span style="text-decoration: underline;">0</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 215 more rows</span></span></span></code></pre></div>
<p>To use these in our calculations, we need to attach the model weights
for each cohort to our current <code>risk_factors</code> dataset using
<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">dplyr::inner_join()</a></code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">risk_factors</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">risk_factors</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Join to get weights</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> </span>
<span>        <span class="va">model_weights</span> <span class="op">|&gt;</span> </span>
<span>          </span>
<span>        <span class="co"># Rename the column</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>          Weight <span class="op">=</span> <span class="va">Value</span></span>
<span>        <span class="op">)</span>,</span>
<span>      by <span class="op">=</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>          <span class="st">"Cohort"</span>,</span>
<span>          <span class="st">"Factor"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">risk_factors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,626 × 5</span></span></span>
<span><span class="co">#&gt;    `ID Number` Factor                                      Value Cohort   Weight</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 <span style="color: #949494;">"</span>Years Over 65 (continuous)<span style="color: #949494;">"</span>                   31 AMI     0.007<span style="text-decoration: underline;">65</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           1 <span style="color: #949494;">"</span>Male<span style="color: #949494;">"</span>                                          1 AMI    -<span style="color: #BB0000;">0.134</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           1 <span style="color: #949494;">"</span>Anterior Myocardial Infarction <span style="color: #949494;">"</span>               0 AMI     0.271  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           1 <span style="color: #949494;">"</span>Non-Anterior Location of Myocardial Infar…     0 AMI     0.071<span style="text-decoration: underline;">2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           1 <span style="color: #949494;">"</span>History of Coronary Artery Bypass Graft (…     1 AMI     0.023<span style="text-decoration: underline;">3</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           1 <span style="color: #949494;">"</span>History of Percutaneous Transluminal Coro…     0 AMI    -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           1 <span style="color: #949494;">"</span>History of COVID-19<span style="color: #949494;">"</span>                           0 AMI    -<span style="color: #BB0000;">0.067</span><span style="color: #BB0000; text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           1 <span style="color: #949494;">"</span>Severe Infection; Other Infectious Diseas…     1 AMI     0.083<span style="text-decoration: underline;">2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           1 <span style="color: #949494;">"</span>Metastatic Cancer and Acute Leukemia<span style="color: #949494;">"</span>          0 AMI     0.226  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           1 <span style="color: #949494;">"</span>Cancer<span style="color: #949494;">"</span>                                        0 AMI     0.044<span style="text-decoration: underline;">0</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,616 more rows</span></span></span></code></pre></div>
<div class="section level5">
<h5 id="linearpredictor">Compute the Linear Predictor<a class="anchor" aria-label="anchor" href="#linearpredictor"></a>
</h5>
<p>These are <a href="https://en.wikipedia.org/wiki/Logistic_regression" class="external-link">logistic
regression</a> models, so to convert to a risk estimate, we need to take
the <em>weighted-sum</em> of each factor weight with the risk factor
value for each discharge.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_predictors</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">risk_factors</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Compute weighted sum</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>      LP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Weight</span> <span class="op">*</span> <span class="va">Value</span><span class="op">)</span>,</span>
<span>      .by <span class="op">=</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>          <span class="va">Cohort</span>,</span>
<span>          <span class="va">`ID Number`</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">linear_predictors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 122 × 3</span></span></span>
<span><span class="co">#&gt;    Cohort `ID Number`    LP</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> AMI              1 1.92 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AMI              2 0.749</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> COPD             1 1.49 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> COPD             2 1.52 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> COPD             3 1.31 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> COPD             4 0.321</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> COPD             5 0.258</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> COPD             6 0.633</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> COPD             7 0.841</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> COPD             8 1.08 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 112 more rows</span></span></span></code></pre></div>
<p>You can think of this as the “risk-adjustment” part, where we’ve
adjusted each patient’s readmission risk based on their own clinical
history. These are on the <a href="https://en.wikipedia.org/wiki/Logit" class="external-link">logit</a> scale (so not yet
probability/risk estimates), but it is what we assume to be linearly
related to the outcome, thus we call it the “linear predictor”. However,
we are still missing something: <strong>the intercept
terms</strong>.</p>
</div>
<div class="section level5">
<h5 id="add-in-the-intercepts">Add In the Intercepts<a class="anchor" aria-label="anchor" href="#add-in-the-intercepts"></a>
</h5>
<p>The <em>predicted</em> and <em>expected</em> readmission risks are
derived from the same risk-adjusted model, the only difference being in
the intercept term that is added to complete the linear predictor. We
can see those in our model weight list:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_weights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span></span>
<span>      <span class="va">Factor</span>,</span>
<span>      pattern <span class="op">=</span> <span class="st">"EFFECT$"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    Factor      Value Cohort</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> HOSP_EFFECT -<span style="color: #BB0000;">2.96</span> AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AVG_EFFECT  -<span style="color: #BB0000;">2.95</span> AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> HOSP_EFFECT -<span style="color: #BB0000;">2.53</span> COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> AVG_EFFECT  -<span style="color: #BB0000;">2.53</span> COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> HOSP_EFFECT -<span style="color: #BB0000;">2.46</span> HF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> AVG_EFFECT  -<span style="color: #BB0000;">2.42</span> HF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> HOSP_EFFECT -<span style="color: #BB0000;">2.51</span> PN    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> AVG_EFFECT  -<span style="color: #BB0000;">2.51</span> PN    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> AVG_EFFECT  -<span style="color: #BB0000;">2.70</span> CABG  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> HOSP_EFFECT -<span style="color: #BB0000;">4.41</span> HK    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> AVG_EFFECT  -<span style="color: #BB0000;">4.28</span> HK</span></span></code></pre></div>
<ul>
<li>The <code>AVG_EFFECT</code> corresponds to the risk-shift
(intercept) associated with being treated at the “average” hospital</li>
<li>The <code>HOSP_EFFECT</code> corresponds to the risk-shift
(intercept) associated with being treated at <em>your</em> hospital</li>
</ul>
<p>These are estimated by CMS using your discharge lists. They are done
so <em>after</em> accounting for all of the risk factors, so by
comparing them we get a measure of how much more or less likely a
patient is to be readmitted at your hospital versus the average
hospital, after risk-adjustment.</p>
<p>We can add each one into our current <code>linear_predictors</code>
to get the complete linear predictors for the predicted and expected
readmission rates:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linear_predictors</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">linear_predictors</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Join to get intercepts</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> </span>
<span>        <span class="va">model_weights</span> <span class="op">|&gt;</span></span>
<span></span>
<span>        <span class="co"># Filter to intercepts</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>          <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span></span>
<span>            <span class="va">Factor</span>,</span>
<span>            pattern <span class="op">=</span> <span class="st">"_EFFECT$"</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        </span>
<span>        <span class="co"># Send over columns</span></span>
<span>        <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>          names_from <span class="op">=</span> <span class="va">Factor</span>,</span>
<span>          values_from <span class="op">=</span> <span class="va">Value</span></span>
<span>        <span class="op">)</span>,</span>
<span>      by <span class="op">=</span> <span class="st">"Cohort"</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    </span>
<span>    <span class="co"># Finish LP's</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      LP_Predicted <span class="op">=</span> <span class="va">LP</span> <span class="op">+</span> <span class="va">HOSP_EFFECT</span>,</span>
<span>      LP_Expected <span class="op">=</span> <span class="va">LP</span> <span class="op">+</span> <span class="va">AVG_EFFECT</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">linear_predictors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 122 × 7</span></span></span>
<span><span class="co">#&gt;    Cohort `ID Number`    LP HOSP_EFFECT AVG_EFFECT LP_Predicted LP_Expected</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> AMI              1 1.92        -<span style="color: #BB0000;">2.96</span>      -<span style="color: #BB0000;">2.95</span>        -<span style="color: #BB0000;">1.03</span>       -<span style="color: #BB0000;">1.03</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AMI              2 0.749       -<span style="color: #BB0000;">2.96</span>      -<span style="color: #BB0000;">2.95</span>        -<span style="color: #BB0000;">2.21</span>       -<span style="color: #BB0000;">2.20</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> COPD             1 1.49        -<span style="color: #BB0000;">2.53</span>      -<span style="color: #BB0000;">2.53</span>        -<span style="color: #BB0000;">1.04</span>       -<span style="color: #BB0000;">1.04</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> COPD             2 1.52        -<span style="color: #BB0000;">2.53</span>      -<span style="color: #BB0000;">2.53</span>        -<span style="color: #BB0000;">1.01</span>       -<span style="color: #BB0000;">1.01</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> COPD             3 1.31        -<span style="color: #BB0000;">2.53</span>      -<span style="color: #BB0000;">2.53</span>        -<span style="color: #BB0000;">1.22</span>       -<span style="color: #BB0000;">1.22</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> COPD             4 0.321       -<span style="color: #BB0000;">2.53</span>      -<span style="color: #BB0000;">2.53</span>        -<span style="color: #BB0000;">2.21</span>       -<span style="color: #BB0000;">2.21</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> COPD             5 0.258       -<span style="color: #BB0000;">2.53</span>      -<span style="color: #BB0000;">2.53</span>        -<span style="color: #BB0000;">2.27</span>       -<span style="color: #BB0000;">2.27</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> COPD             6 0.633       -<span style="color: #BB0000;">2.53</span>      -<span style="color: #BB0000;">2.53</span>        -<span style="color: #BB0000;">1.90</span>       -<span style="color: #BB0000;">1.90</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> COPD             7 0.841       -<span style="color: #BB0000;">2.53</span>      -<span style="color: #BB0000;">2.53</span>        -<span style="color: #BB0000;">1.69</span>       -<span style="color: #BB0000;">1.69</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> COPD             8 1.08        -<span style="color: #BB0000;">2.53</span>      -<span style="color: #BB0000;">2.53</span>        -<span style="color: #BB0000;">1.45</span>       -<span style="color: #BB0000;">1.45</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 112 more rows</span></span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="transform-to-probability-scale">Transform to Probability Scale<a class="anchor" aria-label="anchor" href="#transform-to-probability-scale"></a>
</h5>
<p>The last thing we need to do is transform the linear predictors to
the probabilty scale using the <a href="https://en.wikipedia.org/wiki/Logistic_function" class="external-link">logistic
function</a> in order for our result to be a risk (i.e., a percentage
between 0%-100%).</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">readmission_risks</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">linear_predictors</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Transform LP's</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">LP_Predicted</span>, <span class="va">LP_Expected</span><span class="op">)</span>,</span>
<span>        \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    </span>
<span>    <span class="co"># Keep a few columns</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>      <span class="va">`ID Number`</span>,</span>
<span>      Predicted <span class="op">=</span> <span class="va">LP_Predicted</span>,</span>
<span>      Expected <span class="op">=</span> <span class="va">LP_Expected</span>,</span>
<span>      <span class="va">Cohort</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">readmission_risks</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 122 × 4</span></span></span>
<span><span class="co">#&gt;    `ID Number` Predicted Expected Cohort</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1    0.262    0.264  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2    0.099<span style="text-decoration: underline;">1</span>   0.100<span style="text-decoration: underline;">0</span> AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           1    0.260    0.260  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           2    0.266    0.266  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           3    0.227    0.227  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           4    0.099<span style="text-decoration: underline;">0</span>   0.098<span style="text-decoration: underline;">9</span> COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           5    0.093<span style="text-decoration: underline;">5</span>   0.093<span style="text-decoration: underline;">5</span> COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           6    0.130    0.130  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           7    0.156    0.156  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           8    0.190    0.190  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 112 more rows</span></span></span></code></pre></div>
<p>Now we have the <em>predicted</em> and <em>expected</em> readmission
risk for each discharge.</p>
</div>
<div class="section level5">
<h5 id="readmissionrisks">Doing it Easier<a class="anchor" aria-label="anchor" href="#readmissionrisks"></a>
</h5>
<p>We went through those computations to see how deriving the
readmission risks works starting with the discharges. However, we can
get this automatically by using the <code><a href="../reference/hsr_readmission_risks.html">hsr_readmission_risks()</a></code>
function:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">readmission_risks</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">cohorts</span>, <span class="st">"CABG"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Iterate each cohort</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span></span>
<span></span>
<span>      <span class="co"># Import eligible discharges</span></span>
<span>      <span class="op">~</span><span class="fu"><a href="../reference/hsr_readmission_risks.html">hsr_readmission_risks</a></span><span class="op">(</span></span>
<span>        file <span class="op">=</span> <span class="va">my_report</span>,</span>
<span>        cohort <span class="op">=</span> <span class="va">.x</span></span>
<span>      <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      </span>
<span>      <span class="co"># Indicate cohort</span></span>
<span>      <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/add_column.html" class="external-link">add_column</a></span><span class="op">(</span>Cohort <span class="op">=</span> <span class="va">.x</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">readmission_risks</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 122 × 4</span></span></span>
<span><span class="co">#&gt;    `ID Number` Predicted Expected Cohort</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1    0.262    0.264  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2    0.099<span style="text-decoration: underline;">1</span>   0.100<span style="text-decoration: underline;">0</span> AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           1    0.260    0.260  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           2    0.266    0.266  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           3    0.227    0.227  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           4    0.099<span style="text-decoration: underline;">0</span>   0.098<span style="text-decoration: underline;">9</span> COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           5    0.093<span style="text-decoration: underline;">5</span>   0.093<span style="text-decoration: underline;">5</span> COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           6    0.130    0.130  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           7    0.156    0.156  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           8    0.190    0.190  COPD  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 112 more rows</span></span></span></code></pre></div>
<p>This function extracts eligible discharges and computes the
readmission risk, so it captures everything we just did up to this
point.</p>
</div>
</div>
<div class="section level4">
<h4 id="iv--compute-cohort-level-results">iv. Compute Cohort-Level Results<a class="anchor" aria-label="anchor" href="#iv--compute-cohort-level-results"></a>
</h4>
<p>Now that we have <a href="#readmissionrisks">individual level
readmission risks</a>, we can roll these up to get cohort-level results.
The main calculation we need to do is compute the cohort-level predicted
and expected readmission rates, which is just the <em>average</em> of
the individual ones.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_rates</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">readmission_risks</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Compute cohort-level stats</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>      Discharges <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      Predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Predicted</span><span class="op">)</span>,</span>
<span>      Expected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">Expected</span><span class="op">)</span>,</span>
<span>      .by <span class="op">=</span> <span class="va">Cohort</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">cohort_rates</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">#&gt;   Cohort Discharges Predicted Expected</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AMI             2    0.181    0.182 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> COPD           18    0.165    0.165 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> HF             25    0.159    0.164 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PN             32    0.142    0.141 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> HK             45    0.035<span style="text-decoration: underline;">0</span>   0.039<span style="text-decoration: underline;">7</span></span></span></code></pre></div>
<p>We can compare this to our <a href="#cohortsummary">previous cohort
summary</a> and see that it matches what was already in the table:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_summary</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>      Cohort <span class="op">=</span> <span class="va">`Measure [a]`</span>,</span>
<span>      Discharges <span class="op">=</span> <span class="va">`Number of Eligible Discharges [b]`</span>,</span>
<span>      Predicted <span class="op">=</span> <span class="va">`Predicted Readmission Rate [d]`</span>,</span>
<span>      Expected <span class="op">=</span> <span class="va">`Expected Readmission Rate [e]`</span></span>
<span>    <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   Cohort    Discharges Predicted Expected</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AMI                2    0.181    0.182 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> COPD              18    0.165    0.165 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> HF                25    0.159    0.164 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Pneumonia         32    0.142    0.141 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> CABG              <span style="color: #BB0000;">NA</span>   <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> THA/TKA           45    0.035<span style="text-decoration: underline;">0</span>   0.039<span style="text-decoration: underline;">7</span></span></span></code></pre></div>
<div class="section level5">
<h5 id="cohortcontributions">Pulling in Additional Info<a class="anchor" aria-label="anchor" href="#cohortcontributions"></a>
</h5>
<p>Recall <a href="#cohortsummary">earlier</a> how we calculated the
payment penalty from the cohort-level data. It was done by computing
the:</p>
<ol style="list-style-type: decimal">
<li>Excess readmission ratio (ERR) for each cohort</li>
<li>Difference between (1) and the peer group median ERR for each
cohort</li>
<li>Sum (2) across cohorts, weighted by DRG ratios</li>
</ol>
<p>We can do (1) right away with our current <code>cohort_rates</code>
dataset:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_rates</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">cohort_rates</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Compute the ERR</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      ERR <span class="op">=</span> <span class="va">Predicted</span> <span class="op">/</span> <span class="va">Expected</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">cohort_rates</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 5</span></span></span>
<span><span class="co">#&gt;   Cohort Discharges Predicted Expected   ERR</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AMI             2    0.181    0.182  0.993</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> COPD           18    0.165    0.165  1.00 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> HF             25    0.159    0.164  0.971</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PN             32    0.142    0.141  1.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> HK             45    0.035<span style="text-decoration: underline;">0</span>   0.039<span style="text-decoration: underline;">7</span> 0.882</span></span></code></pre></div>
<p>For the rest, we need to add the peer group medians and DRG ratios to
our <code>cohort_rates</code> dataset, which we can get from our
existing <code>cohort_summary</code> dataset that we <a href="#cohortsummary">extracted earlier</a>:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_rates</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">cohort_rates</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Join to get reference info</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span></span>
<span>      y <span class="op">=</span> </span>
<span>        <span class="va">cohort_summary</span> <span class="op">|&gt;</span></span>
<span></span>
<span>        <span class="co"># Make matching names</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>          Cohort <span class="op">=</span> <span class="va">`Measure [a]`</span>,</span>
<span>          Cohort <span class="op">=</span> </span>
<span>            <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>              <span class="va">Cohort</span> <span class="op">==</span> <span class="st">"Pneumonia"</span> <span class="op">~</span> <span class="st">"PN"</span>,</span>
<span>              <span class="va">Cohort</span> <span class="op">==</span> <span class="st">"THA/TKA"</span> <span class="op">~</span> <span class="st">"HK"</span>,</span>
<span>              <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Cohort</span></span>
<span>            <span class="op">)</span></span>
<span>        <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        </span>
<span>        <span class="co"># Keep a few columns</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>          <span class="va">Cohort</span>,</span>
<span>          PeerGroupERR <span class="op">=</span> <span class="va">`Peer Group Median ERR [g]`</span>,</span>
<span>          DRGRatio <span class="op">=</span> <span class="va">`Ratio of DRG Payments Per Measure to Total Payments [i]`</span></span>
<span>        <span class="op">)</span>,</span>
<span>      by <span class="op">=</span> <span class="st">"Cohort"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">cohort_rates</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 7</span></span></span>
<span><span class="co">#&gt;   Cohort Discharges Predicted Expected   ERR PeerGroupERR DRGRatio</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AMI             2    0.181    0.182  0.993        0.996  0.002<span style="text-decoration: underline;">73</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> COPD           18    0.165    0.165  1.00         0.992  0.022<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> HF             25    0.159    0.164  0.971        0.996  0.032<span style="text-decoration: underline;">2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PN             32    0.142    0.141  1.01         0.991  0.049<span style="text-decoration: underline;">4</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> HK             45    0.035<span style="text-decoration: underline;">0</span>   0.039<span style="text-decoration: underline;">7</span> 0.882        0.996  0.104</span></span></code></pre></div>
<p>Finally, we can indicate which cohorts received penalty and how much
they contributed. Recall, a cohort is only eligible to receive penalty
if:</p>
<ol style="list-style-type: decimal">
<li>They have at least 25 discharges</li>
<li>The ERR is greater than the peer group median ERR</li>
</ol>
<p>Thus, we can see, for example, that the COPD group had an ERR greater
than the peer group median, but won’t actually contribute penalty
because there were too few cases. Let’s compute the actual contribution
for each cohort:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cohort_rates</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">cohort_rates</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Compute penalty contribution</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      IsPenalized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">ERR</span> <span class="op">&gt;</span> <span class="va">PeerGroupERR</span> <span class="op">&amp;</span> <span class="va">Discharges</span> <span class="op">&gt;=</span> <span class="fl">25</span><span class="op">)</span>,</span>
<span>      PenaltyContribution <span class="op">=</span> <span class="op">(</span><span class="va">ERR</span> <span class="op">-</span> <span class="va">PeerGroupERR</span><span class="op">)</span> <span class="op">*</span> <span class="va">DRGRatio</span>,</span>
<span>      PenaltyContribution <span class="op">=</span> <span class="va">IsPenalized</span> <span class="op">*</span> <span class="va">PenaltyContribution</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">cohort_rates</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 9</span></span></span>
<span><span class="co">#&gt;   Cohort Discharges Predicted Expected   ERR PeerGroupERR DRGRatio IsPenalized</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AMI             2    0.181    0.182  0.993        0.996  0.002<span style="text-decoration: underline;">73</span>           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> COPD           18    0.165    0.165  1.00         0.992  0.022<span style="text-decoration: underline;">6</span>            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> HF             25    0.159    0.164  0.971        0.996  0.032<span style="text-decoration: underline;">2</span>            0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> PN             32    0.142    0.141  1.01         0.991  0.049<span style="text-decoration: underline;">4</span>            1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> HK             45    0.035<span style="text-decoration: underline;">0</span>   0.039<span style="text-decoration: underline;">7</span> 0.882        0.996  0.104             0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: PenaltyContribution &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Ultimately, based on these criteria, this hospital is only penalized
in the Pneumonia cohort.</p>
</div>
</div>
<div class="section level4">
<h4 id="v--aggregate-to-the-program-result">v. Aggregate to the Program Result<a class="anchor" aria-label="anchor" href="#v--aggregate-to-the-program-result"></a>
</h4>
<p>Now that we have the <a href="#cohortcontributions">contributions of
each cohort</a>, we can aggregate them into our final penalty amount.
We’ll do this step by step:</p>
<ol style="list-style-type: decimal">
<li>Add up the cohort contributions</li>
</ol>
<p>We just computed these in the prior step.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp_penalty</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cohort_rates</span><span class="op">$</span><span class="va">PenaltyContribution</span><span class="op">)</span></span>
<span><span class="va">temp_penalty</span></span>
<span><span class="co">#&gt; [1] 0.0007729462</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Multiply (1) by the neutrality modifier</li>
</ol>
<p>The neutrality modifier was found in our <a href="#programsummary">program summary</a> earlier. We can just extract
from there.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penalty</span> <span class="op">&lt;-</span> <span class="va">temp_penalty</span> <span class="op">*</span> <span class="va">my_payment_summary</span><span class="op">$</span><span class="va">`Neutrality Modifier [e]`</span></span>
<span><span class="va">penalty</span></span>
<span><span class="co">#&gt; [1] 0.0007460787</span></span></code></pre></div>
<p>We can see that matches what was reported in the <a href="#programsummary">program summary</a>:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_payment_summary</span><span class="op">$</span><span class="va">`Payment Reduction Percentage [f]`</span></span>
<span><span class="co">#&gt; [1] 7e-04</span></span></code></pre></div>
<p>This is the final penalty amount.</p>
<div class="section level5">
<h5 id="implication">Implication<a class="anchor" aria-label="anchor" href="#implication"></a>
</h5>
<p>Recall that the (mock) report we’ve been working with is from
FY2025.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_report</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/readmit/extdata/FY2025_HRRP_MockHSR.xlsx"</span></span></code></pre></div>
<p>Let’s remind ourselves of the payment period for this program
year:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_payment_period</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">hrrp_payment_periods</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">ProgramYear</span> <span class="op">==</span> <span class="fl">2025</span><span class="op">)</span></span>
<span><span class="va">my_payment_period</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   ProgramYear StartDate  EndDate   </span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>        <span style="text-decoration: underline;">2</span>025 2024-10-01 2025-09-30</span></span></code></pre></div>
<p>So from 10/01/2024 through 09/30/2025, all Medicare payments for this
hospital were reduced by 0.075%.</p>
</div>
</div>
<div class="section level4">
<h4 id="key-observations">Key Observations<a class="anchor" aria-label="anchor" href="#key-observations"></a>
</h4>
<p>Some important things to note about the penalty calculation:</p>
<div class="section level5">
<h5 id="readmissions-themselves-dont-compute-penalty">Readmissions Themselves Don’t Compute Penalty<a class="anchor" aria-label="anchor" href="#readmissions-themselves-dont-compute-penalty"></a>
</h5>
<p>Notice that in the calculation of the penalty, we never explicity
used or pulled out the actual discharges that readmitted, or used an
“observed” readmission rate (i.e., the simple fraction of discharges
that were readmitted). Instead, <em>all</em> discharges were fed into a
statistical model to compute the predicted and expected readmission
rates for the whole group, and then were aggregated. The actual
readmission cases at your hospital were used upstream to fit that
statistical model, in a pool along with data from all other hospitals.
Thus, the readmissions from your hospital only contribute in an indirect
way: they inform the resulting <em>hospital effect</em> estimated from
the statistical model, after adjusting for clinical history, which in
turn is built into the calculated <em>predicted</em> readmission rate
that is computed on each discharge and used downstream in the penalty
calculation.</p>
</div>
<div class="section level5">
<h5 id="cohorts-arent-weighted-equally">Cohorts Aren’t Weighted Equally<a class="anchor" aria-label="anchor" href="#cohorts-arent-weighted-equally"></a>
</h5>
<p>First, remember that even if a cohort has excessive readmissions,
they may not contribute to the penalty if there aren’t enough
discharges. But beyond that point: the cohort-level contribution to the
penalty is not necessarily proportional to how many readmissions they
had. It also has to do with how many of those patients are seen at the
hospital. Recall that we took the penalty contribution amount and
multiplied it by the ratio of DRG’s relevant to that cohort out of all
payments. This means that it is possible that a cohort with a slight
excess in readmissions can contribute much more to the overall penalty
amount than another cohort with huge excess, if the former is a much
more high-volume diagnosis at your hospital. So you must consider the
full picture.</p>
</div>
<div class="section level5">
<h5 id="statistical-models-arent-perfect">Statistical Models Aren’t Perfect<a class="anchor" aria-label="anchor" href="#statistical-models-arent-perfect"></a>
</h5>
<p>Recall that CMS fits random-intercept logistic regression models on a
combined dataset from all participating hospitals for each cohort. There
are tons of assumptions and nuances that go into these models that make
them far from perfect arbitors of truth. For example, each risk factor
is added to the model as an independent factor, so no interactions
between them are assumed. Additionally, effects are estimated on a
combined dataset for all hospitals, which therefore assumes the effect
of each clinical factor for risk adjustment is the same for all
hospitals. On top of that, each of these risk factors is defined by
claims documentation, and, specifically, groupings of ICD codes that may
be inconsistent across hospitals. Then, these models are used to
estimate individual level readmission risks, leading to group-level
excess readmission ratios, that are then compared to a peer group
<em>median</em> value to indicate penalty–so by definition, half of
hospitals are getting flagged no matter what, even if everyone is doing
well. We could keep going down the list of nuances, but it’s important
to at least acknowledge and understand the mechanics of how these things
work.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="understanding-model-weights">2. Understanding Model Weights<a class="anchor" aria-label="anchor" href="#understanding-model-weights"></a>
</h3>
<p>As described <a href="#modelcoefficients">previously</a>, the
<em>predicted</em> and <em>expected</em> readmission rates are based on
risk models developed by CMS that estimate hospital-level effects so
that individual hospitals can be compared to an “average” hospital for
penalty determination. Additionally, these models <em>risk-adjust</em>
for individual patient clinical history as to tease out impacts due to
the <em>hospital</em> itself instead of the overall morbidity of the
population it serves. Thus, each model contains a long list of
covariates (risk factors) which can be explored to gain further insight
into the mechanics of the program. You can find more details about the
model methodology <a href="https://qualitynet.cms.gov/inpatient/measures/readmission/methodology" class="external-link">here</a>.</p>
<div class="section level4">
<h4 id="what-do-they-mean">What Do They Mean?<a class="anchor" aria-label="anchor" href="#what-do-they-mean"></a>
</h4>
<p>The first thing worth understanding are what the model estimates mean
and how to interpret them. Recall from <a href="#modelcoefficients">above</a> that we can extract the model
coefficients, which are found in the first row of the discharge-level
data for each cohort, from the HSR with the
<code><a href="../reference/hsr_coefficients.html">hsr_coefficients()</a></code> function, which we previously extracted
<a href="#individualreadmissionrisk">above</a>:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_weights</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 225 × 3</span></span></span>
<span><span class="co">#&gt;    Factor                                                           Value Cohort</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span>Years Over 65 (continuous)<span style="color: #949494;">"</span>                                   0.007<span style="text-decoration: underline;">65</span> AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>Male<span style="color: #949494;">"</span>                                                        -<span style="color: #BB0000;">0.134</span>   AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>Anterior Myocardial Infarction <span style="color: #949494;">"</span>                              0.271   AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>Non-Anterior Location of Myocardial Infarction<span style="color: #949494;">"</span>               0.071<span style="text-decoration: underline;">2</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>History of Coronary Artery Bypass Graft (CABG) Surgery<span style="color: #949494;">"</span>       0.023<span style="text-decoration: underline;">3</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>History of Percutaneous Transluminal Coronary Angioplasty (… -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">8</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>History of COVID-19<span style="color: #949494;">"</span>                                         -<span style="color: #BB0000;">0.067</span><span style="color: #BB0000; text-decoration: underline;">6</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>Severe Infection; Other Infectious Diseases<span style="color: #949494;">"</span>                  0.083<span style="text-decoration: underline;">2</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>Metastatic Cancer and Acute Leukemia<span style="color: #949494;">"</span>                         0.226   AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>Cancer<span style="color: #949494;">"</span>                                                       0.044<span style="text-decoration: underline;">0</span>  AMI   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 215 more rows</span></span></span></code></pre></div>
<p>These are the weights (coefficients) of the regression equation that
we use to weight individual patient risk factors. Remember that these
are currently on the scale of the <a href="#linearpredictor">linear
predictor</a>. To make them intuitive and interpretable. we can
<em>exponentiate</em> them to put them on the <em><a href="https://en.wikipedia.org/wiki/Odds_ratio" class="external-link">odds ratio</a></em>
scale.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_weights</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    OR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 225 × 4</span></span></span>
<span><span class="co">#&gt;    Factor                                                     Value Cohort    OR</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #949494;">"</span>Years Over 65 (continuous)<span style="color: #949494;">"</span>                             0.007<span style="text-decoration: underline;">65</span> AMI    1.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #949494;">"</span>Male<span style="color: #949494;">"</span>                                                  -<span style="color: #BB0000;">0.134</span>   AMI    0.875</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #949494;">"</span>Anterior Myocardial Infarction <span style="color: #949494;">"</span>                        0.271   AMI    1.31 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #949494;">"</span>Non-Anterior Location of Myocardial Infarction<span style="color: #949494;">"</span>         0.071<span style="text-decoration: underline;">2</span>  AMI    1.07 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #949494;">"</span>History of Coronary Artery Bypass Graft (CABG) Surger…  0.023<span style="text-decoration: underline;">3</span>  AMI    1.02 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #949494;">"</span>History of Percutaneous Transluminal Coronary Angiopl… -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">8</span>  AMI    0.978</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #949494;">"</span>History of COVID-19<span style="color: #949494;">"</span>                                   -<span style="color: #BB0000;">0.067</span><span style="color: #BB0000; text-decoration: underline;">6</span>  AMI    0.935</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #949494;">"</span>Severe Infection; Other Infectious Diseases<span style="color: #949494;">"</span>            0.083<span style="text-decoration: underline;">2</span>  AMI    1.09 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #949494;">"</span>Metastatic Cancer and Acute Leukemia<span style="color: #949494;">"</span>                   0.226   AMI    1.25 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #949494;">"</span>Cancer<span style="color: #949494;">"</span>                                                 0.044<span style="text-decoration: underline;">0</span>  AMI    1.04 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 215 more rows</span></span></span></code></pre></div>
<p>For example, according to these estimates, the odds of a readmission
for males are 12.5% lower than females on average for the AMI cohort. So
one thing we can do is assess these across all factors to better
understand how each risk factor is weighted, by which direction, and how
much.</p>
<div class="section level5">
<h5 id="relative-importance">Relative Importance<a class="anchor" aria-label="anchor" href="#relative-importance"></a>
</h5>
<p>A more tractable way to organize them for understanding is to rank
them by the magnitude of their effects to get a sense of which factors
have the most impact on the readmission risk calculation. Here we’ll
make a plot of the top five (5) most heavily-weighted factors for each
cohort:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">model_weights</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co"># Remove intercepts</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Factor</span>, <span class="st">"_EFFECT$"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Rank by group</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="st">"Cohort"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Filter to top 10</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Rank</span> <span class="op">&lt;=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Make a plot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_linerange</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">Factor</span>, <span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>      ymin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>      ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_sub.html" class="external-link">str_sub</a></span><span class="op">(</span><span class="va">Factor</span>, <span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Cohort</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Risk Factor"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Odds Ratio"</span><span class="op">)</span></span></code></pre></div>
<p><img src="investigating-an-hsr_files/figure-html/unnamed-chunk-49-1.png" class="r-plt" width="700"></p>
<p>We can see, for example, that <em>Dialysis Status</em> is an
important factor that shows up across multiple cohort models, thus
having heavy impact on program results.</p>
<p>We can create the full listing in a table format:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glin.github.io/reactable/" class="external-link">reactable</a></span><span class="op">)</span></span>
<span><span class="va">model_weights</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co"># Remove intercepts</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Factor</span>, <span class="st">"_EFFECT$"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Rank by group</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="st">"Cohort"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Compute odds ratio</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    OR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Rearrange</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">Cohort</span>,</span>
<span>    <span class="va">Factor</span>,</span>
<span>    <span class="va">Rank</span>,</span>
<span>    <span class="va">Value</span>,</span>
<span>    <span class="va">OR</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span></span>
<span>    <span class="va">Cohort</span>,</span>
<span>    <span class="va">Rank</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Make a table</span></span>
<span>  <span class="fu"><a href="https://glin.github.io/reactable/reference/reactable.html" class="external-link">reactable</a></span><span class="op">(</span></span>
<span>    groupBy <span class="op">=</span> <span class="st">"Cohort"</span>,</span>
<span>    columns <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        Factor <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Risk Factor"</span><span class="op">)</span>,</span>
<span>        Value <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Coefficient"</span>, format <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colFormat.html" class="external-link">colFormat</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        OR <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Odds-Ratio"</span>, format <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colFormat.html" class="external-link">colFormat</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      searchable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      sortable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      filterable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      resizable <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="reactable html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Cohort":["AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","CABG","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN"],"Factor":["Congestive Heart Failure","Anterior Myocardial Infarction ","Renal Failure","Dialysis Status","Metastatic Cancer and Acute Leukemia","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Chronic Obstructive Pulmonary Disease (COPD)","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Diabetes Mellitus (DM) or DM Complications","Pneumonia","Protein-Calorie Malnutrition","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Male","Specified Arrhythmias and Other Heart Rhythm Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Coronary Atherosclerosis/ Other Chronic Ischemic Heart Disease","Valvular and Rheumatic Heart Disease","Vascular or Circulatory Disease","Severe Infection; Other Infectious Diseases","Other Urinary Tract Disorders","Non-Anterior Location of Myocardial Infarction","History of COVID-19","Cerebrovascular Disease","Stroke","Cancer","Acute Coronary Syndrome","Angina Pectoris","History of Coronary Artery Bypass Graft (CABG) Surgery","History of Percutaneous Transluminal Coronary Angioplasty (PTCA)","Asthma","Years Over 65 (continuous)","Dementia or Other Specified Brain Disorders","Dialysis Status","Renal Failure","Male","Congestive Heart Failure","Decubitus Ulcer or Chronic Skin Ulcer","Chronic Obstructive Pulmonary Disease (COPD)","Protein-Calorie Malnutrition","Severe Hematological Disorders","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Diabetes Mellitus (DM) or DM Complications","Pneumonia","Dementia or Other Specified Brain Disorders","Polyneuropathy; Other Neuropathies","Cardiogenic Shock","Other Respiratory Disorders","Morbid Obesity; Other Endocrine/Metabolic/Nutritional Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Vascular or Circulatory Disease","Specified Arrhythmias and Other Heart Rhythm Disorders","Major Psychiatric Disorders","Stroke","History of COVID-19","Years Over 65 (continuous)","Cerebrovascular Disease","Fibrosis of Lung or Other Chronic Lung Disorders","History of Coronary Artery Bypass Graft (CABG) or Valve Surgery","Cancer; Metastatic Cancer and Acute Leukemia","History of Mechanical Ventilation","Congestive Heart Failure","Cardio-respiratory Failure and Shock","Metastatic Cancer and Acute Leukemia","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Drug/Alcohol Psychosis or Dependence","Specified Arrhythmias and Other Heart Rhythm Disorders","Renal Failure","Lung and Other Severe Cancers","Severe Hematological Disorders","Protein-Calorie Malnutrition","Fibrosis of Lung or Other Chronic Lung Disorders","Other Psychiatric Disorders","Diabetes Mellitus (DM) or DM Complications","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Acute Coronary Syndrome","Anxiety Disorders","Other Gastrointestinal Disorders","Vertebral Fractures Without Spinal Cord Injury","Pneumonia","Other Digestive and Urinary Neoplasms","Decubitus Ulcer or Chronic Skin Ulcer","Other and Unspecified Heart Disease","Chronic Pancreatitis","Vascular or Circulatory Disease","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Coronary Atherosclerosis or Angina","Major Psychiatric Disorders","Cellulitis, Local Skin Infection","Severe Infection; Other Infectious Diseases","Sleep-Disordered Breathing","Polyneuropathy; Other Neuropathies","Morbid Obesity; Other Endocrine/ Metabolic/ Nutritional Disorders","Depression","History of COVID-19","Dementia or Other Specified Brain Disorders","Respirator Dependence/Respiratory Failure","Stroke","Years Over 65 (continuous)","Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms","Renal Failure","Severe Hematological Disorders","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Chronic Obstructive Pulmonary Disease (COPD)","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Dialysis Status","Metastatic Cancer and Acute Leukemia","Pneumonia","Decubitus Ulcer or Chronic Skin Ulcer","Congestive Heart Failure","Acute Coronary Syndrome","Specified Arrhythmias and Other Heart Rhythm Disorders","Diabetes Mellitus (DM) or DM Complications","Drug/Alcohol Abuse/ Dependence/Psychosis","Liver or Biliary Disease","Protein-Calorie Malnutrition","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Vascular or Circulatory Disease","Valvular and Rheumatic Heart Disease","Other Psychiatric Disorders","Coronary Atherosclerosis or Angina","Cardio-Respiratory Failure and Shock","Other Gastrointestinal Disorders","Fibrosis of Lung or Other Chronic Lung Disorders","Nephritis","Other Urinary Tract Disorders","Other and Unspecified Heart Disease","Male","Stroke","Major Psychiatric Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","Depression","Cancer","Dementia or Other Specified Brain Disorders","Years Over 65 (continuous)","Asthma","History of COVID-19","Dialysis Status","Severe Hematological Disorders","Other Congenital Deformity of Hip (Joint)","Congestive Heart Failure","Chronic Obstructive Pulmonary Disease (COPD)","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Major Psychiatric Disorders","Renal Failure","Morbid Obesity","Decubitus Ulcer or Chronic Skin Ulcer","Specified Arrhythmias and Other Heart Rhythm Disorders","Index Admissions with an Elective THA Procedure","Dementia or Other Specified Brain Disorders","Male","Pneumonia","Hypertension","Other Injuries","Cellulitis, Local Skin Infection","Rheumatoid Arthritis and Inflammatory Connective Tissue Disease","Protein-Calorie Malnutrition","Coronary Atherosclerosis or Angina","Number of Procedures (two vs. one)","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Diabetes Mellitus (DM) or DM Complications","Vascular or Circulatory Disease","Major Symptoms, Abnormalities","Stroke","Polyneuropathy; Other Neuropathies","Metastatic Cancer and Acute Leukemia","Severe Infection; Other Infectious Diseases","Years Over 65 (continuous)","History of COVID-19","Cancer","Post Traumatic Osteoarthritis","Severe Hematological Disorders","Dialysis Status","Congestive Heart Failure","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Metastatic Cancer and Acute Leukemia","Respirator Dependence/Tracheostomy Status","Pleural Effusion/Pneumothorax","Chronic Obstructive Pulmonary Disease (COPD)","Renal Failure","Lung and Other Severe Cancers","Protein-Calorie Malnutrition","Septicemia, Sepsis, Systemic Inflammatory Response Syndrome/Shock","Decubitus Ulcer or Chronic Skin Ulcer","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Fibrosis of Lung or Other Chronic Lung Disorders","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Pneumonia","Specified Arrhythmias and Other Heart Rhythm Disorders","Diabetes Mellitus (DM) or DM Complications","History of COVID-19","Acute Coronary Syndrome","Other Gastrointestinal Disorders","Drug/Alcohol Abuse/Dependence/Psychosis","Other Psychiatric Disorders","Respiratory Arrest; Cardio-Respiratory Failure and Shock","Urinary Tract Infection","Vascular or Circulatory Disease","Valvular and Rheumatic Heart Disease","Other Urinary Tract Disorders","Vertebral Fractures Without Spinal Cord Injury","Coronary Atherosclerosis or Angina","Severe Infection; Other Infectious Diseases","History of Coronary Artery Bypass Graft (CABG) Surgery","Stroke","Lymphoma; Other Cancers","Male","Other Respiratory Disorders","Major Psychiatric Disorders","Other Injuries","Years Over 65 (continuous)","Asthma","Dementia or Other Specified Brain Disorders"],"Rank":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],"Value":[0.33957243074671,0.27100275921083,0.26177130895785,0.25127110061188,0.22634890641462,0.22465852292459,0.20889600190574,0.18728702112007,0.18363519022453,0.16362948864226,0.14477909636915,0.14174229352292,-0.13377094797325,0.12834192882491,0.11440519285484,0.10175224371917,0.09968987228144,0.09943077750067,0.08324200070107,0.07545016852382,0.07120286291483,-0.0676429056577,0.05614466547329,0.04570363659622,0.04401442147305,0.0297614483081,0.02729795306472,0.02331580008699,-0.02178937903037,0.01695937962873,0.00765330879237,0.00703750490067,0.35818303029402,0.29143239275745,-0.28332728852419,0.2800446325316,0.27300580017862,0.26484564483108,0.26370785697943,0.26154055665819,0.19114552705245,0.15786295143238,0.1511681537206,0.14566619001395,0.13107528477562,0.12957699458811,0.12184220387001,-0.11691556053706,0.10490316401824,0.10464292366885,0.09889417588161,0.08747730777201,0.07037263002522,-0.04492223071892,0.02767499869282,-0.02389210984846,0.01718013343108,0.00902984145127,-0.00332420831438,0.29280807156464,0.2439415793327,0.22038178999048,0.20104445264549,0.18328054402919,0.17681007960757,0.16445038235307,0.16108300640596,0.16003937693966,0.15641571251929,0.14811373057356,0.14281362472359,0.09533030999425,0.09114373098859,0.0890658422646,0.08820129638075,0.08369753436147,0.08328503809818,0.08250218578877,0.08224193320365,0.07955108252904,-0.07920807606545,0.07294989023911,0.07153773924385,0.06293681682419,0.06087761722765,0.05564420968061,0.04904567748974,0.04427640612473,0.04118173223991,0.03808035282907,-0.03389473810138,0.03215598707713,-0.02388404741238,0.02313345493758,-0.02003981846797,0.01206184755198,0.01120929463448,-0.00864104299739,-0.00550489429206,-0.0034296550888,0.25467622994391,0.23762950955586,0.16255670466746,0.15927075502566,0.15184667522785,0.15063453076202,0.14874300720604,0.11689320548651,0.11392662096829,0.1016609291805,0.09790277908018,0.09682630620285,0.09677714822051,0.09145549141705,0.08650221507101,0.08560777795158,0.0742789500502,0.0723520680848,0.07185907371904,0.07058646898766,0.06772100095278,0.06340647519094,0.06051633638107,0.05653031652753,0.05413448733244,0.05285914464513,0.04461504793124,0.03603726506083,-0.03586725467682,0.03184030056073,0.02511695897923,0.01986402655318,0.01541403711219,0.01262653085985,0.00975548315292,-0.0058876745155,0.00404853256189,-0.00239294251728,0.5978782174907,0.29881994243779,0.28564566526498,0.2723238654975,0.25480313855337,0.24543227729109,0.23494388360546,0.22799144692474,0.22298546250043,0.20960556510495,0.17376971474725,0.16317044297896,0.15538492166378,0.14771744300593,0.14606104955108,0.14328115783213,0.14248311993964,0.13988994687991,0.13935558883477,0.13277839169882,0.13100204057882,0.1286610446364,0.1224436188646,0.11981420121191,0.10992796636631,0.09528675586484,0.08923188109521,0.08487023427136,0.0799645208149,0.04508274963675,0.03857725723824,-0.02583679305955,-0.021371850181,-1.52018641e-05,0.26359064734308,0.24009331029806,0.19422199453265,0.18194701681503,0.17827066953589,0.17600014087344,0.1606016141625,0.13139244938143,0.12708573624157,0.12270154741653,0.12196238167798,0.11855382669326,0.11631820787447,0.11023929530957,0.10848046835409,0.1072630978906,0.10709471281501,0.09977928562087,0.09004469255696,-0.0767024905464,0.07105773620641,0.06175525419797,0.06078806879643,0.05806411686367,0.05240883963648,0.05229959267784,0.05191332162581,0.04899146976652,0.04270544546113,0.03936136215198,0.03285307899265,0.03053426003874,-0.02980557296489,0.02877533874591,0.02813765867189,0.02436651587802,0.02356441710246,0.0184252173479,0.00894405564906,-0.00890555581122,-0.00763712593242,-0.00405389134248],"OR":[1.40434700657616,1.31127868847395,1.29922938632986,1.28565857991806,1.25401312218034,1.2518951496995,1.23231683326371,1.20597337520888,1.20157739594988,1.17777785416899,1.15578422513392,1.15227966033888,0.874790414174569,1.13694168937752,1.12120633765287,1.10710914450208,1.10482822708194,1.10454200893507,1.08680478424652,1.0783694896356,1.07379903777738,0.934594152280405,1.05775069267337,1.04676414239889,1.04499742518198,1.03020874659868,1.02767395575626,1.02358973823982,0.978446294657523,1.01710400634375,1.00768267021632,1.0070623263311,1.43072746298482,1.33834314874191,0.753273209833681,1.3231888682885,1.31390786570295,1.30322979999659,1.30174784419777,1.2989296207483,1.21063561949572,1.17100569905634,1.1631922367401,1.1568099688729,1.14005360676125,1.13834675462822,1.1295758450197,0.889660312430832,1.11060305881081,1.11031407268731,1.10394946889795,1.09141749746726,1.07290790447466,0.956071831961017,1.02806150878639,0.976391047053408,1.01732856070524,1.0090707334597,0.99668131074888,1.34018554603127,1.27626976777999,1.24655256103836,1.22267912193687,1.20115133665262,1.19340441976714,1.17874508154332,1.17478247923821,1.17355708116837,1.16931219978582,1.15964477592895,1.15351479499191,1.10002214343179,1.09542644066927,1.09315262960155,1.09220795741027,1.08729997318708,1.08685155850211,1.08600104720536,1.08571844940038,1.08280087032362,0.923847673855356,1.07567663366527,1.07415868787304,1.06495954957909,1.06276884163083,1.05722146764992,1.05026832326495,1.04527123433375,1.04204146086774,1.03881470122512,0.966673253144263,1.0326785772551,0.976398919175548,1.02340310863209,0.980159644074325,1.01213488499526,1.01127235417498,0.991396183512194,0.994510229873486,0.996576219460403,1.29004387567186,1.26823923525535,1.17651503045079,1.17265540604647,1.16398175551224,1.16257169623939,1.16037474293993,1.12399938631304,1.1206698881957,1.10700805395688,1.10285555926439,1.10166900392913,1.10161484943477,1.09576800452604,1.09035378292616,1.08937896605059,1.07710722270742,1.07503376252324,1.0745039075538,1.07313735851998,1.07006671923253,1.06545983421404,1.062384952954,1.05815869401114,1.05562656100928,1.05428113351708,1.04562526681456,1.03669447825391,0.964768353470128,1.0323526260044,1.02543504734744,1.02006262916481,1.01553344611831,1.01270658206884,1.00980322299415,0.994129623874354,1.0040567389407,0.997609918287297,1.81825675924455,1.34826683597601,1.3306208865114,1.31301217179861,1.2902076037353,1.2781737192729,1.26483778860496,1.25607458208597,1.249802404602,1.23319155023515,1.18978154512627,1.17723732442611,1.16810750446418,1.15918531416689,1.15726683651509,1.1540542274412,1.15313361582805,1.15014721460233,1.14953278836153,1.14199689429525,1.13997010750847,1.13730456334368,1.13025539319517,1.12728738349084,1.11619766378927,1.09997423396834,1.09333415045518,1.08857579770109,1.08324863421437,1.04611442191559,1.03933102110065,0.974494120834844,0.97885490951141,0.999984798251448,1.30159527574775,1.27136777649297,1.21436583561166,1.1995506361829,1.19514876782156,1.19243822663353,1.17421708416427,1.14041524876104,1.13551436834238,1.13054695593161,1.12971160312608,1.1258674741942,1.12335327512397,1.11654522252815,1.11458313868254,1.11322710365637,1.11303966860744,1.10492701787976,1.09422318624449,0.926165355571123,1.07364321216502,1.06370197627399,1.06267367660932,1.05978294349047,1.05380649231681,1.05369137345083,1.05328444157356,1.05021139215344,1.04363044348821,1.04014628524584,1.03339870010939,1.03100521172221,0.97063423273985,1.02919334863171,1.02853726174997,1.02466580536269,1.02384425170249,1.01859600901031,1.00898417323021,0.991133981197538,0.992391962815253,0.99595431458264]},"columns":[{"id":"Cohort","name":"Cohort","type":"character"},{"id":"Factor","name":"Risk Factor","type":"character"},{"id":"Rank","name":"Rank","type":"numeric"},{"id":"Value","name":"Coefficient","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}}},{"id":"OR","name":"Odds-Ratio","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}}}],"groupBy":["Cohort"],"resizable":true,"filterable":true,"searchable":true,"dataKey":"e0d7afee0d1a9a6a7d3cb81f7787c7e0"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="section level4">
<h4 id="risk-factor-prevalence">Risk Factor Prevalence<a class="anchor" aria-label="anchor" href="#risk-factor-prevalence"></a>
</h4>
<p>We now understand the model output, but how can we incorporate the
risk factors in our discharge datasets to gain additional insight?</p>
<p>Recall, the way we calculated the readmission risks was by taking a
weighted-sum of the risk factors in our dataset with the model weights
(and then doing some transformations to turn it into a probability). We
just established that different factors yield different effects (weight)
on the readmission risks from the model side and how that can be useful
for understanding how CMS weights different clinical history
factors.</p>
<p>The next thing we can seek to understand is how prevalent each of the
risk factors are for your cohort. This is useful for a few reasons:</p>
<ol style="list-style-type: decimal">
<li>You can compare to see if the rates of various risk factors are
similar for your hospital versus peer group hospitals</li>
<li>It gives insight into the difference between model importance for
readmission risk vs. how prevalent the risk factor is</li>
<li>We can use the combination of model weights and prevalence of risk
factors to understand overall impact. For example, a risk factor that
has an average impact in terms of odds-ratio but has very high
prevalence at your hospital may have more overall net impact on your
HRRP readmission metrics than the most important factor according to the
model but has very few patients with it at your hospital.</li>
</ol>
<p>The first step get at this analysis is to compute these from your
datasets. We can do this by manipulating the output of
<code><a href="../reference/hsr_discharges.html">hsr_discharges()</a></code> after using the
<code>risk_factors=TRUE</code> argument. Here is an example of how we’d
do this for AMI:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="va">my_report</span>,</span>
<span>  cohort <span class="op">=</span> <span class="st">"AMI"</span>,</span>
<span>  discharge_phi <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  risk_factors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  eligible_only <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 33</span></span></span>
<span><span class="co">#&gt;   `ID Number` `Years Over 65 (continuous)`  Male Anterior Myocardial Infarctio…¹</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>           1                           31     1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>           2                           27     1                               0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`Anterior Myocardial Infarction `</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 29 more variables: `Non-Anterior Location of Myocardial Infarction` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `History of Coronary Artery Bypass Graft (CABG) Surgery` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `History of Percutaneous Transluminal Coronary Angioplasty (PTCA)` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `History of COVID-19` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Severe Infection; Other Infectious Diseases` &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   `Metastatic Cancer and Acute Leukemia` &lt;dbl&gt;, Cancer &lt;dbl&gt;, …</span></span></span></code></pre></div>
<p>However, we’ve already <a href="#riskfactors">done this earlier</a>
in our exercises, so we’ll use that <code>risk_factors</code>
dataset:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">risk_factors</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,626 × 5</span></span></span>
<span><span class="co">#&gt;    `ID Number` Factor                                      Value Cohort   Weight</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1 <span style="color: #949494;">"</span>Years Over 65 (continuous)<span style="color: #949494;">"</span>                   31 AMI     0.007<span style="text-decoration: underline;">65</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           1 <span style="color: #949494;">"</span>Male<span style="color: #949494;">"</span>                                          1 AMI    -<span style="color: #BB0000;">0.134</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           1 <span style="color: #949494;">"</span>Anterior Myocardial Infarction <span style="color: #949494;">"</span>               0 AMI     0.271  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           1 <span style="color: #949494;">"</span>Non-Anterior Location of Myocardial Infar…     0 AMI     0.071<span style="text-decoration: underline;">2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           1 <span style="color: #949494;">"</span>History of Coronary Artery Bypass Graft (…     1 AMI     0.023<span style="text-decoration: underline;">3</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           1 <span style="color: #949494;">"</span>History of Percutaneous Transluminal Coro…     0 AMI    -<span style="color: #BB0000;">0.021</span><span style="color: #BB0000; text-decoration: underline;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           1 <span style="color: #949494;">"</span>History of COVID-19<span style="color: #949494;">"</span>                           0 AMI    -<span style="color: #BB0000;">0.067</span><span style="color: #BB0000; text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           1 <span style="color: #949494;">"</span>Severe Infection; Other Infectious Diseas…     1 AMI     0.083<span style="text-decoration: underline;">2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           1 <span style="color: #949494;">"</span>Metastatic Cancer and Acute Leukemia<span style="color: #949494;">"</span>          0 AMI     0.226  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>           1 <span style="color: #949494;">"</span>Cancer<span style="color: #949494;">"</span>                                        0 AMI     0.044<span style="text-decoration: underline;">0</span> </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4,616 more rows</span></span></span></code></pre></div>
<p>Now we can compute the prevalence for each risk factor (in each
cohort) by simply taking the average <code>Value</code>, because all of
these are binary factors (except for Age):</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prevalence</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">risk_factors</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Remove age (for demo purposes)</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Factor</span>, <span class="st">"^Years"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>    <span class="co"># Compute average</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>      N <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      Count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span>,</span>
<span>      Rate <span class="op">=</span> <span class="va">Count</span> <span class="op">/</span> <span class="va">N</span>,</span>
<span>      .by <span class="op">=</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>          <span class="va">Cohort</span>,</span>
<span>          <span class="va">Factor</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">prevalence</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 182 × 5</span></span></span>
<span><span class="co">#&gt;    Cohort Factor                                                   N Count  Rate</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> AMI    <span style="color: #949494;">"</span>Male<span style="color: #949494;">"</span>                                                   2     2   1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> AMI    <span style="color: #949494;">"</span>Anterior Myocardial Infarction <span style="color: #949494;">"</span>                        2     0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> AMI    <span style="color: #949494;">"</span>Non-Anterior Location of Myocardial Infarction<span style="color: #949494;">"</span>         2     0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> AMI    <span style="color: #949494;">"</span>History of Coronary Artery Bypass Graft (CABG) Sur…     2     1   0.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> AMI    <span style="color: #949494;">"</span>History of Percutaneous Transluminal Coronary Angi…     2     1   0.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> AMI    <span style="color: #949494;">"</span>History of COVID-19<span style="color: #949494;">"</span>                                    2     0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> AMI    <span style="color: #949494;">"</span>Severe Infection; Other Infectious Diseases<span style="color: #949494;">"</span>            2     1   0.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> AMI    <span style="color: #949494;">"</span>Metastatic Cancer and Acute Leukemia<span style="color: #949494;">"</span>                   2     0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> AMI    <span style="color: #949494;">"</span>Cancer<span style="color: #949494;">"</span>                                                 2     0   0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> AMI    <span style="color: #949494;">"</span>Diabetes Mellitus (DM) or DM Complications<span style="color: #949494;">"</span>             2     1   0.5</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 172 more rows</span></span></span></code></pre></div>
<p>Then we could put all of these into a navigatable table:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prevalence</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>    <span class="co"># Arrange</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Cohort</span>, <span class="fu">desc</span><span class="op">(</span><span class="va">Rate</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    </span>
<span>    <span class="co"># Make a table</span></span>
<span>    <span class="fu"><a href="https://glin.github.io/reactable/reference/reactable.html" class="external-link">reactable</a></span><span class="op">(</span></span>
<span>      groupBy <span class="op">=</span> <span class="st">"Cohort"</span>,</span>
<span>      columns <span class="op">=</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          Factor <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Risk Factor"</span><span class="op">)</span>,</span>
<span>          N <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Discharge Count"</span><span class="op">)</span>,</span>
<span>          Count <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span>,</span>
<span>          Rate <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Percent"</span>, format <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colFormat.html" class="external-link">colFormat</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span>, percent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>      columnGroups <span class="op">=</span> </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://glin.github.io/reactable/reference/colGroup.html" class="external-link">colGroup</a></span><span class="op">(</span></span>
<span>            name <span class="op">=</span> <span class="st">"Risk Factor Prevalence"</span>,</span>
<span>            columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Count"</span>, <span class="st">"Rate"</span><span class="op">)</span></span>
<span>          <span class="op">)</span></span>
<span>        <span class="op">)</span>,</span>
<span>      searchable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      sortable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      filterable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      resizable <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="reactable html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Cohort":["AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN"],"Factor":["Male","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Renal Failure","History of Coronary Artery Bypass Graft (CABG) Surgery","History of Percutaneous Transluminal Coronary Angioplasty (PTCA)","Severe Infection; Other Infectious Diseases","Diabetes Mellitus (DM) or DM Complications","Dementia or Other Specified Brain Disorders","Congestive Heart Failure","Coronary Atherosclerosis/ Other Chronic Ischemic Heart Disease","Specified Arrhythmias and Other Heart Rhythm Disorders","Chronic Obstructive Pulmonary Disease (COPD)","Asthma","Other Urinary Tract Disorders","Anterior Myocardial Infarction ","Non-Anterior Location of Myocardial Infarction","History of COVID-19","Metastatic Cancer and Acute Leukemia","Cancer","Protein-Calorie Malnutrition","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Acute Coronary Syndrome","Angina Pectoris","Valvular and Rheumatic Heart Disease","Stroke","Cerebrovascular Disease","Vascular or Circulatory Disease","Pneumonia","Dialysis Status","Decubitus Ulcer or Chronic Skin Ulcer","Cardio-respiratory Failure and Shock","Morbid Obesity; Other Endocrine/ Metabolic/ Nutritional Disorders","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Other Gastrointestinal Disorders","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Congestive Heart Failure","Diabetes Mellitus (DM) or DM Complications","Polyneuropathy; Other Neuropathies","Vascular or Circulatory Disease","Renal Failure","Depression","Specified Arrhythmias and Other Heart Rhythm Disorders","Pneumonia","Other Psychiatric Disorders","Sleep-Disordered Breathing","Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms","Severe Infection; Other Infectious Diseases","Anxiety Disorders","History of Mechanical Ventilation","History of COVID-19","Drug/Alcohol Psychosis or Dependence","Acute Coronary Syndrome","Coronary Atherosclerosis or Angina","Other and Unspecified Heart Disease","Metastatic Cancer and Acute Leukemia","Protein-Calorie Malnutrition","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Dementia or Other Specified Brain Disorders","Major Psychiatric Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Respirator Dependence/Respiratory Failure","Cellulitis, Local Skin Infection","Vertebral Fractures Without Spinal Cord Injury","Lung and Other Severe Cancers","Other Digestive and Urinary Neoplasms","Chronic Pancreatitis","Severe Hematological Disorders","Stroke","Fibrosis of Lung or Other Chronic Lung Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Specified Arrhythmias and Other Heart Rhythm Disorders","Other Gastrointestinal Disorders","Congestive Heart Failure","Cardio-Respiratory Failure and Shock","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Renal Failure","Coronary Atherosclerosis or Angina","Male","Diabetes Mellitus (DM) or DM Complications","Valvular and Rheumatic Heart Disease","Vascular or Circulatory Disease","Depression","Chronic Obstructive Pulmonary Disease (COPD)","Other Psychiatric Disorders","Other and Unspecified Heart Disease","Other Urinary Tract Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","Liver or Biliary Disease","Pneumonia","Dementia or Other Specified Brain Disorders","Cancer","Drug/Alcohol Abuse/ Dependence/Psychosis","Acute Coronary Syndrome","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Major Psychiatric Disorders","Stroke","Fibrosis of Lung or Other Chronic Lung Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Protein-Calorie Malnutrition","Asthma","History of COVID-19","Metastatic Cancer and Acute Leukemia","Severe Hematological Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Dialysis Status","Nephritis","Hypertension","Major Symptoms, Abnormalities","Male","Diabetes Mellitus (DM) or DM Complications","Specified Arrhythmias and Other Heart Rhythm Disorders","Other Injuries","Index Admissions with an Elective THA Procedure","Renal Failure","Morbid Obesity","Polyneuropathy; Other Neuropathies","Chronic Obstructive Pulmonary Disease (COPD)","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Congestive Heart Failure","Rheumatoid Arthritis and Inflammatory Connective Tissue Disease","Coronary Atherosclerosis or Angina","Vascular or Circulatory Disease","Severe Infection; Other Infectious Diseases","Cancer","Pneumonia","Number of Procedures (two vs. one)","Metastatic Cancer and Acute Leukemia","Protein-Calorie Malnutrition","Severe Hematological Disorders","Stroke","Cellulitis, Local Skin Infection","Other Congenital Deformity of Hip (Joint)","Post Traumatic Osteoarthritis","History of COVID-19","Dementia or Other Specified Brain Disorders","Major Psychiatric Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Dialysis Status","Decubitus Ulcer or Chronic Skin Ulcer","Respiratory Arrest; Cardio-Respiratory Failure and Shock","Male","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Chronic Obstructive Pulmonary Disease (COPD)","Other Gastrointestinal Disorders","Specified Arrhythmias and Other Heart Rhythm Disorders","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Congestive Heart Failure","Other Respiratory Disorders","Diabetes Mellitus (DM) or DM Complications","Renal Failure","Other Injuries","Pneumonia","Lymphoma; Other Cancers","Vascular or Circulatory Disease","Severe Infection; Other Infectious Diseases","Dementia or Other Specified Brain Disorders","Coronary Atherosclerosis or Angina","Valvular and Rheumatic Heart Disease","Other Psychiatric Disorders","Pleural Effusion/Pneumothorax","Decubitus Ulcer or Chronic Skin Ulcer","Asthma","Urinary Tract Infection","Septicemia, Sepsis, Systemic Inflammatory Response Syndrome/Shock","Drug/Alcohol Abuse/Dependence/Psychosis","Other Urinary Tract Disorders","Protein-Calorie Malnutrition","Acute Coronary Syndrome","Metastatic Cancer and Acute Leukemia","Vertebral Fractures Without Spinal Cord Injury","History of Coronary Artery Bypass Graft (CABG) Surgery","History of COVID-19","Lung and Other Severe Cancers","Severe Hematological Disorders","Major Psychiatric Disorders","Stroke","Fibrosis of Lung or Other Chronic Lung Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Respirator Dependence/Tracheostomy Status","Dialysis Status"],"N":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],"Count":[2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,12,10,9,9,9,8,8,8,7,6,6,6,5,4,4,3,3,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,18,17,17,16,15,14,14,13,12,12,10,9,8,8,6,6,6,5,5,5,4,3,3,3,2,2,2,2,2,1,1,0,0,0,0,0,0,29,23,19,13,12,12,10,9,7,7,7,6,4,3,3,3,2,2,2,1,1,1,1,1,1,0,0,0,0,0,0,0,0,25,24,22,19,17,16,15,13,13,11,11,11,10,9,9,8,8,8,8,7,7,6,5,5,4,4,4,3,3,2,2,1,1,1,1,1,1,1,0,0,0],"Rate":[1,1,1,1,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.833333333333333,0.666666666666667,0.555555555555556,0.5,0.5,0.5,0.444444444444444,0.444444444444444,0.444444444444444,0.388888888888889,0.333333333333333,0.333333333333333,0.333333333333333,0.277777777777778,0.222222222222222,0.222222222222222,0.166666666666667,0.166666666666667,0.111111111111111,0.111111111111111,0.111111111111111,0.111111111111111,0.111111111111111,0.111111111111111,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0,0,0,0,0,0,0,0.72,0.68,0.68,0.64,0.6,0.56,0.56,0.52,0.48,0.48,0.4,0.36,0.32,0.32,0.24,0.24,0.24,0.2,0.2,0.2,0.16,0.12,0.12,0.12,0.08,0.08,0.08,0.08,0.08,0.04,0.04,0,0,0,0,0,0,0.644444444444444,0.511111111111111,0.422222222222222,0.288888888888889,0.266666666666667,0.266666666666667,0.222222222222222,0.2,0.155555555555556,0.155555555555556,0.155555555555556,0.133333333333333,0.0888888888888889,0.0666666666666667,0.0666666666666667,0.0666666666666667,0.0444444444444444,0.0444444444444444,0.0444444444444444,0.0222222222222222,0.0222222222222222,0.0222222222222222,0.0222222222222222,0.0222222222222222,0.0222222222222222,0,0,0,0,0,0,0,0,0.78125,0.75,0.6875,0.59375,0.53125,0.5,0.46875,0.40625,0.40625,0.34375,0.34375,0.34375,0.3125,0.28125,0.28125,0.25,0.25,0.25,0.25,0.21875,0.21875,0.1875,0.15625,0.15625,0.125,0.125,0.125,0.09375,0.09375,0.0625,0.0625,0.03125,0.03125,0.03125,0.03125,0.03125,0.03125,0.03125,0,0,0]},"columns":[{"id":"Cohort","name":"Cohort","type":"character"},{"id":"Factor","name":"Risk Factor","type":"character"},{"id":"N","name":"Discharge Count","type":"numeric"},{"id":"Count","name":"Count","type":"numeric"},{"id":"Rate","name":"Percent","type":"numeric","format":{"cell":{"digits":1,"percent":true},"aggregated":{"digits":1,"percent":true}}}],"columnGroups":[{"name":"Risk Factor Prevalence","columns":["Count","Rate"]}],"groupBy":["Cohort"],"resizable":true,"filterable":true,"searchable":true,"dataKey":"517ed1869ca3b676da7ccde083b9b408"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="net-factor-influence">Net Factor Influence<a class="anchor" aria-label="anchor" href="#net-factor-influence"></a>
</h4>
<p>We can then combine the two concepts above (model weights + risk
factor prevalence) to explore which factors may have the most overall
impact. One way to quantify this is by computing the total weight of a
risk factor by taking the number of patients with the risk factor
multiplied by the model weight.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prevalence</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co"># Join to get model weight</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">model_weights</span>,</span>
<span>    by <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Cohort"</span>,</span>
<span>        <span class="st">"Factor"</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Make total weight</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    NetImpact <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Count</span> <span class="op">*</span> <span class="va">Value</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Arrange</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Cohort</span>, <span class="fu">desc</span><span class="op">(</span><span class="va">NetImpact</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">NetImpact</span>, .after <span class="op">=</span> <span class="va">Factor</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    </span>
<span>  <span class="co"># Make a table</span></span>
<span>  <span class="fu"><a href="https://glin.github.io/reactable/reference/reactable.html" class="external-link">reactable</a></span><span class="op">(</span></span>
<span>    groupBy <span class="op">=</span> <span class="st">"Cohort"</span>,</span>
<span>    columns <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        Factor <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Risk Factor"</span><span class="op">)</span>,</span>
<span>        NetImpact <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Net Impact"</span>, format <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colFormat.html" class="external-link">colFormat</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        N <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Discharge Count"</span><span class="op">)</span>,</span>
<span>        Count <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span>,</span>
<span>        Rate <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colDef.html" class="external-link">colDef</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Percent"</span>, format <span class="op">=</span> <span class="fu"><a href="https://glin.github.io/reactable/reference/colFormat.html" class="external-link">colFormat</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span>, percent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>    columnGroups <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://glin.github.io/reactable/reference/colGroup.html" class="external-link">colGroup</a></span><span class="op">(</span></span>
<span>          name <span class="op">=</span> <span class="st">"Risk Factor Prevalence"</span>,</span>
<span>          columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Count"</span>, <span class="st">"Rate"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>    searchable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    sortable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    filterable <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    resizable <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="reactable html-widget html-fill-item" id="htmlwidget-36aa3d2a04d42bbc2145" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Cohort":["AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","AMI","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","COPD","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HF","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","HK","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN","PN"],"Factor":["Renal Failure","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Congestive Heart Failure","Male","Chronic Obstructive Pulmonary Disease (COPD)","Diabetes Mellitus (DM) or DM Complications","Specified Arrhythmias and Other Heart Rhythm Disorders","Coronary Atherosclerosis/ Other Chronic Ischemic Heart Disease","Severe Infection; Other Infectious Diseases","Other Urinary Tract Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","History of Percutaneous Transluminal Coronary Angioplasty (PTCA)","Asthma","Dementia or Other Specified Brain Disorders","Anterior Myocardial Infarction ","Non-Anterior Location of Myocardial Infarction","History of COVID-19","Metastatic Cancer and Acute Leukemia","Cancer","Protein-Calorie Malnutrition","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Acute Coronary Syndrome","Angina Pectoris","Valvular and Rheumatic Heart Disease","Stroke","Cerebrovascular Disease","Vascular or Circulatory Disease","Pneumonia","Dialysis Status","Decubitus Ulcer or Chronic Skin Ulcer","Cardio-respiratory Failure and Shock","Congestive Heart Failure","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Renal Failure","Specified Arrhythmias and Other Heart Rhythm Disorders","Other Gastrointestinal Disorders","Diabetes Mellitus (DM) or DM Complications","History of Mechanical Ventilation","Vascular or Circulatory Disease","Pneumonia","Other Psychiatric Disorders","Drug/Alcohol Psychosis or Dependence","Morbid Obesity; Other Endocrine/ Metabolic/ Nutritional Disorders","Polyneuropathy; Other Neuropathies","Anxiety Disorders","Metastatic Cancer and Acute Leukemia","Acute Coronary Syndrome","Other and Unspecified Heart Disease","Protein-Calorie Malnutrition","Depression","Sleep-Disordered Breathing","Severe Infection; Other Infectious Diseases","Coronary Atherosclerosis or Angina","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Vertebral Fractures Without Spinal Cord Injury","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Major Psychiatric Disorders","Cellulitis, Local Skin Infection","History of COVID-19","Lymphatic, Head and Neck, Brain, and Other Major Cancers; Breast, Colorectal and Other Cancers and Tumors; Other Respiratory and Heart Neoplasms","Dementia or Other Specified Brain Disorders","Respirator Dependence/Respiratory Failure","Lung and Other Severe Cancers","Other Digestive and Urinary Neoplasms","Chronic Pancreatitis","Severe Hematological Disorders","Stroke","Fibrosis of Lung or Other Chronic Lung Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Renal Failure","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Specified Arrhythmias and Other Heart Rhythm Disorders","Congestive Heart Failure","Chronic Obstructive Pulmonary Disease (COPD)","Diabetes Mellitus (DM) or DM Complications","Cardio-Respiratory Failure and Shock","Other Gastrointestinal Disorders","Coronary Atherosclerosis or Angina","Valvular and Rheumatic Heart Disease","Vascular or Circulatory Disease","Pneumonia","Liver or Biliary Disease","Male","Other Psychiatric Disorders","Acute Coronary Syndrome","Drug/Alcohol Abuse/ Dependence/Psychosis","Other Urinary Tract Disorders","Decubitus Ulcer or Chronic Skin Ulcer","Other and Unspecified Heart Disease","Peptic Ulcer, Hemorrhage, Other Specified Gastrointestinal Disorders","Depression","Fibrosis of Lung or Other Chronic Lung Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","Protein-Calorie Malnutrition","Stroke","Major Psychiatric Disorders","Dementia or Other Specified Brain Disorders","Cancer","Asthma","History of COVID-19","Metastatic Cancer and Acute Leukemia","Severe Hematological Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Dialysis Status","Nephritis","Hypertension","Male","Major Symptoms, Abnormalities","Specified Arrhythmias and Other Heart Rhythm Disorders","Renal Failure","Chronic Obstructive Pulmonary Disease (COPD)","Other Injuries","Index Admissions with an Elective THA Procedure","Morbid Obesity","Diabetes Mellitus (DM) or DM Complications","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Congestive Heart Failure","Polyneuropathy; Other Neuropathies","Rheumatoid Arthritis and Inflammatory Connective Tissue Disease","Coronary Atherosclerosis or Angina","Vascular or Circulatory Disease","Severe Hematological Disorders","Pneumonia","Cellulitis, Local Skin Infection","Protein-Calorie Malnutrition","Number of Procedures (two vs. one)","Severe Infection; Other Infectious Diseases","Stroke","Metastatic Cancer and Acute Leukemia","Cancer","Other Congenital Deformity of Hip (Joint)","Post Traumatic Osteoarthritis","History of COVID-19","Dementia or Other Specified Brain Disorders","Major Psychiatric Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Dialysis Status","Decubitus Ulcer or Chronic Skin Ulcer","Iron Deficiency or Other/Unspecified Anemias and Blood Disease","Congestive Heart Failure","Chronic Obstructive Pulmonary Disease (COPD)","Other Significant Endocrine and Metabolic Disorders; Disorders of Fluid/Electrolyte/Acid-base Balance","Specified Arrhythmias and Other Heart Rhythm Disorders","Renal Failure","Respiratory Arrest; Cardio-Respiratory Failure and Shock","Pleural Effusion/Pneumothorax","Pneumonia","Other Gastrointestinal Disorders","Diabetes Mellitus (DM) or DM Complications","Decubitus Ulcer or Chronic Skin Ulcer","Male","Septicemia, Sepsis, Systemic Inflammatory Response Syndrome/Shock","Vascular or Circulatory Disease","Other Psychiatric Disorders","Valvular and Rheumatic Heart Disease","Protein-Calorie Malnutrition","Metastatic Cancer and Acute Leukemia","Other Respiratory Disorders","Severe Hematological Disorders","Coronary Atherosclerosis or Angina","Urinary Tract Infection","Lymphoma; Other Cancers","Severe Infection; Other Infectious Diseases","Drug/Alcohol Abuse/Dependence/Psychosis","Acute Coronary Syndrome","Other Urinary Tract Disorders","Lung and Other Severe Cancers","Fibrosis of Lung or Other Chronic Lung Disorders","Other Injuries","Vertebral Fractures Without Spinal Cord Injury","History of COVID-19","Asthma","Dementia or Other Specified Brain Disorders","History of Coronary Artery Bypass Graft (CABG) Surgery","Stroke","Major Psychiatric Disorders","Hemiplegia, Paraplegia, Paralysis, Functional Disability","Respirator Dependence/Tracheostomy Status","Dialysis Status"],"NetImpact":[0.5235426179157,0.44931704584918,0.37457404224014,0.33957243074671,0.2675418959465,0.20889600190574,0.18363519022453,0.12834192882491,0.10175224371917,0.08324200070107,0.07545016852382,0.02331580008699,0.02178937903037,0.01695937962873,0.00703750490067,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.3057268498572,2.1954742139943,1.7681007960757,1.64952489626271,1.12027563857762,0.96649803843576,0.74251967209893,0.7125267381168,0.58561614312928,0.4870209378212,0.47730649517424,0.45571865494295,0.32890076470614,0.28660856894856,0.25724789661704,0.24985511429454,0.20104445264549,0.16739506872294,0.1430754784877,0.14281362472359,0.13880072962548,0.13557895240552,0.11424105848721,0.09809135497948,0.08820129638075,0.08224193320365,0.05564420968061,0.04427640612473,0.04118173223991,0.04007963693594,0.0137186203552,0.01206184755198,0.01120929463448,0,0,0,0,0,0,0,3.56546721921474,2.4383505700119,2.1258534531899,1.7428735116513,1.7282357960685,1.27416604020528,1.16132577864612,0.96826138209712,0.96101538096801,0.82428417748222,0.7058646898766,0.64673166347136,0.58446602743255,0.43251107535505,0.43040705612184,0.40632600571668,0.29370833724054,0.27436647425115,0.26769028758744,0.22785324193658,0.21622359036498,0.1447041361696,0.12331229689752,0.10826897466488,0.0993201327659,0.08560777795158,0.06368060112146,0.05023391795846,0.03902193261168,0.03787959257955,0.00404853256189,0,0,0,0,0,0,4.15515357713177,2.80663141711267,2.19159538489132,2.085236576967,2.05192302232266,1.78362196987359,1.70979743927568,1.6317044297896,1.56089823750301,1.55758461575483,1.47259366374654,1.08929546199,0.59409163989952,0.41806676650431,0.39300612173646,0.32978389909893,0.29881994243779,0.29212209910216,0.13988994687991,0.13277839169882,0.1286610446364,0.0901654992735,0.08923188109521,0.0799645208149,0.042743700362,0,0,0,0,0,0,0,0,2.72920525222545,2.52488592892445,2.49645653824717,2.3597881535932,1.59646856993392,1.39794309865727,1.310220990912,1.1242112991375,1.0709471281501,1.04983932136549,0.99049161812656,0.69790924724682,0.58479638107248,0.47421530677304,0.46721989463229,0.40644881804569,0.39193175813216,0.36588714503394,0.35654133907178,0.30633742233198,0.26359064734308,0.2628246319412,0.2614979633892,0.25323892804701,0.24427408030992,0.24315227518572,0.21317320861923,0.17082178184452,0.12270154741653,0.10848046835409,0.09838461213966,0.07872272430396,0.0767024905464,0.0381856296621,0.03243113073984,0.02980557296489,0.02877533874591,0.0184252173479,0,0,0],"N":[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32],"Count":[2,2,2,1,2,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,9,10,9,7,6,9,8,2,8,6,5,2,12,8,3,1,2,2,1,6,4,3,2,1,1,1,1,1,2,4,1,1,0,0,0,0,0,0,0,14,15,14,18,17,8,12,16,17,13,10,9,5,5,12,6,3,3,6,2,6,2,8,2,5,1,2,2,4,3,1,0,0,0,0,0,0,29,19,23,12,9,7,12,10,7,13,6,4,7,3,3,3,1,2,1,1,1,2,1,1,2,0,0,0,0,0,0,0,0,15,13,19,22,16,11,25,7,10,17,11,6,24,4,9,7,8,3,2,13,1,8,5,9,8,4,3,4,1,1,11,2,1,5,8,1,1,1,0,0,0],"Rate":[1,1,1,0.5,1,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.833333333333333,0.5,0.555555555555556,0.5,0.388888888888889,0.333333333333333,0.5,0.444444444444444,0.111111111111111,0.444444444444444,0.333333333333333,0.277777777777778,0.111111111111111,0.666666666666667,0.444444444444444,0.166666666666667,0.0555555555555556,0.111111111111111,0.111111111111111,0.0555555555555556,0.333333333333333,0.222222222222222,0.166666666666667,0.111111111111111,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.0555555555555556,0.111111111111111,0.222222222222222,0.0555555555555556,0.0555555555555556,0,0,0,0,0,0,0,0.56,0.6,0.56,0.72,0.68,0.32,0.48,0.64,0.68,0.52,0.4,0.36,0.2,0.2,0.48,0.24,0.12,0.12,0.24,0.08,0.24,0.08,0.32,0.08,0.2,0.04,0.08,0.08,0.16,0.12,0.04,0,0,0,0,0,0,0.644444444444444,0.422222222222222,0.511111111111111,0.266666666666667,0.2,0.155555555555556,0.266666666666667,0.222222222222222,0.155555555555556,0.288888888888889,0.133333333333333,0.0888888888888889,0.155555555555556,0.0666666666666667,0.0666666666666667,0.0666666666666667,0.0222222222222222,0.0444444444444444,0.0222222222222222,0.0222222222222222,0.0222222222222222,0.0444444444444444,0.0222222222222222,0.0222222222222222,0.0444444444444444,0,0,0,0,0,0,0,0,0.46875,0.40625,0.59375,0.6875,0.5,0.34375,0.78125,0.21875,0.3125,0.53125,0.34375,0.1875,0.75,0.125,0.28125,0.21875,0.25,0.09375,0.0625,0.40625,0.03125,0.25,0.15625,0.28125,0.25,0.125,0.09375,0.125,0.03125,0.03125,0.34375,0.0625,0.03125,0.15625,0.25,0.03125,0.03125,0.03125,0,0,0],"Value":[0.26177130895785,0.22465852292459,0.18728702112007,0.33957243074671,-0.13377094797325,0.20889600190574,0.18363519022453,0.12834192882491,0.10175224371917,0.08324200070107,0.07545016852382,0.02331580008699,-0.02178937903037,0.01695937962873,0.00703750490067,0.27100275921083,0.07120286291483,-0.0676429056577,0.22634890641462,0.04401442147305,0.14477909636915,0.14174229352292,0.0297614483081,0.02729795306472,0.09968987228144,0.04570363659622,0.05614466547329,0.09943077750067,0.16362948864226,0.25127110061188,0.11440519285484,0.22038178999048,0.2439415793327,0.17681007960757,0.18328054402919,0.16003937693966,0.16108300640596,0.08250218578877,0.0890658422646,0.29280807156464,0.06087761722765,0.07955108252904,0.09114373098859,0.16445038235307,-0.02388404741238,0.03215598707713,0.08328503809818,0.20104445264549,0.08369753436147,0.07153773924385,0.14281362472359,0.02313345493758,-0.03389473810138,0.03808035282907,0.04904567748974,0.08820129638075,0.08224193320365,0.05564420968061,0.04427640612473,0.04118173223991,-0.02003981846797,-0.0034296550888,0.01206184755198,0.01120929463448,0.15641571251929,-0.07920807606545,0.06293681682419,0.14811373057356,-0.00864104299739,0.09533030999425,0.07294989023911,0.25467622994391,0.16255670466746,0.15184667522785,0.09682630620285,0.1016609291805,0.15927075502566,0.09677714822051,0.06051633638107,0.05653031652753,0.06340647519094,0.07058646898766,0.07185907371904,0.11689320548651,0.08650221507101,-0.03586725467682,0.06772100095278,0.09790277908018,0.09145549141705,0.04461504793124,0.11392662096829,0.03603726506083,0.0723520680848,0.01541403711219,0.05413448733244,0.01986402655318,0.08560777795158,0.03184030056073,0.02511695897923,0.00975548315292,0.01262653085985,0.00404853256189,-0.00239294251728,0.14874300720604,0.23762950955586,0.0742789500502,0.15063453076202,0.05285914464513,0.14328115783213,0.14771744300593,0.09528675586484,0.17376971474725,0.22799144692474,0.25480313855337,0.14248311993964,0.16317044297896,0.22298546250043,0.11981420121191,0.24543227729109,0.2723238654975,0.08487023427136,0.13935558883477,0.13100204057882,0.10992796636631,0.29881994243779,0.14606104955108,0.13988994687991,0.13277839169882,0.1286610446364,0.04508274963675,0.08923188109521,0.0799645208149,-0.021371850181,0.28564566526498,-1.52018641e-05,-0.02583679305955,0.15538492166378,0.23494388360546,0.1224436188646,0.5978782174907,0.20960556510495,0.18194701681503,0.19422199453265,0.13139244938143,0.1072630978906,0.09977928562087,0.12708573624157,0.05240883963648,0.1606016141625,0.10709471281501,0.06175525419797,0.09004469255696,0.11631820787447,0.02436651587802,0.11855382669326,0.05191332162581,0.05806411686367,0.04899146976652,0.12196238167798,0.17827066953589,0.02356441710246,0.26359064734308,0.03285307899265,0.05229959267784,0.02813765867189,0.03053426003874,0.06078806879643,0.07105773620641,0.04270544546113,0.12270154741653,0.10848046835409,0.00894405564906,0.03936136215198,-0.0767024905464,-0.00763712593242,-0.00405389134248,-0.02980557296489,0.02877533874591,0.0184252173479,0.11023929530957,0.17600014087344,0.24009331029806]},"columns":[{"id":"Cohort","name":"Cohort","type":"character"},{"id":"Factor","name":"Risk Factor","type":"character"},{"id":"NetImpact","name":"Net Impact","type":"numeric","format":{"cell":{"digits":2},"aggregated":{"digits":2}}},{"id":"N","name":"Discharge Count","type":"numeric"},{"id":"Count","name":"Count","type":"numeric"},{"id":"Rate","name":"Percent","type":"numeric","format":{"cell":{"digits":1,"percent":true},"aggregated":{"digits":1,"percent":true}}},{"id":"Value","name":"Value","type":"numeric"}],"columnGroups":[{"name":"Risk Factor Prevalence","columns":["Count","Rate"]}],"groupBy":["Cohort"],"resizable":true,"filterable":true,"searchable":true,"dataKey":"e32991bf80ecaa70061e95ab294ab68b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script><p>If you scan through the table you’ll notice that the risk factors
that have the highest model weight or highest prevalence are not
necessarily the ones with the most net impact.</p>
<p>Finally, we could put these in a plot:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prevalence</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co"># Join to get model weight</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span></span>
<span>    y <span class="op">=</span> <span class="va">model_weights</span>,</span>
<span>    by <span class="op">=</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="st">"Cohort"</span>,</span>
<span>        <span class="st">"Factor"</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">Count</span>,</span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">Value</span><span class="op">)</span>,</span>
<span>      color <span class="op">=</span> <span class="va">Cohort</span></span>
<span>    <span class="op">)</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Cohort</span>, scales <span class="op">=</span> <span class="st">"free_x"</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Risk Factor Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Odds Ratio"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="investigating-an-hsr_files/figure-html/unnamed-chunk-56-1.png" class="r-plt" width="700"></p>
<p>Points that are closer to the upper-right quadrant are the most
influential. Of course, it would be useful to add interactivity to these
plots (e.g., with <code>plotly</code>) as to provide the user ability to
scan and view what risk factor each point represents, but you get the
idea.</p>
<div class="section level5">
<h5 id="how-are-risk-factors-defined">How Are Risk Factors Defined?<a class="anchor" aria-label="anchor" href="#how-are-risk-factors-defined"></a>
</h5>
<p>Each of these risk factors themselves have specific definitions under
the hood, which is yet another layer of nuance to keep in mind when
thinking about how program results roll up.</p>
<ul>
<li><p>Condition categories</p></li>
<li>
<p>Average readmisson risks to get group level metric;</p>
<ul>
<li>High prevalence, low impact vs. low prevalence, high impact</li>
</ul>
</li>
<li><p>Plot showing prevalence vs. model weight</p></li>
<li><p>condition categories</p></li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="other-analyses">3. Other Analyses<a class="anchor" aria-label="anchor" href="#other-analyses"></a>
</h3>
<p>There are many other possible questions that can be answered
analyzing an HSR that can be useful for better understand HRRP program
results. We’ll list a few more ideas here without actually doing
them:</p>
<div class="section level4">
<h4 id="diagnosis-comparison">Diagnosis Comparison<a class="anchor" aria-label="anchor" href="#diagnosis-comparison"></a>
</h4>
<p>In the discharge reports, CMS supplies the diagnosis code the patient
received that led their index discharge to be included in the program.
For those who are readmitted, also supplied in this table are the
diagnosis codes received at their readmission stay. These can be
accessed with the <code><a href="../reference/hsr_discharges.html">hsr_discharges()</a></code> function and extracting
the appropriate columns. Here’s an example doing this for the HF
cohort:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="va">my_report</span>,</span>
<span>  cohort <span class="op">=</span> <span class="st">"HF"</span>,</span>
<span>  eligible_only <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co"># Keep diagnosis columns</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"Diagnosis"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  </span>
<span>  <span class="co"># Aggregate</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    N <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 3</span></span></span>
<span><span class="co">#&gt;   `Principal Discharge Diagnosis of Index Stay` Principal Discharge Diag…¹     N</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> I110                                          <span style="color: #BB0000;">NA</span>                            12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> I130                                          <span style="color: #BB0000;">NA</span>                             5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> I5033                                         <span style="color: #BB0000;">NA</span>                             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> I5033                                         I130                           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> I130                                          A0472                          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> I132                                          U071                           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> I509                                          <span style="color: #BB0000;">NA</span>                             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> I5023                                         <span style="color: #BB0000;">NA</span>                             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span> I5043                                         <span style="color: #BB0000;">NA</span>                             1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated name: ¹​`Principal Discharge Diagnosis of Readmission`</span></span></span></code></pre></div>
<p>This can be extremely useful to understand (a) which diagnoses are
leading to cohort inclusion to begin with, and (b) why the patient came
back. Sometimes there may be readmissions that are completely unrelated
to the index diagnosis.</p>
</div>
</div>
<div class="section level3">
<h3 id="outside-hospital-readmissions">Outside Hospital Readmissions<a class="anchor" aria-label="anchor" href="#outside-hospital-readmissions"></a>
</h3>
<p>Since CMS enforces the HRRP, hospitals get penalized for readmissions
that don’t even occur at their hospital. If a patient is discharged from
your hospital and subsequently readmitted somewhere else, it still
counts as <em>your</em> readmission. Thus it is useful to understand the
rate of readmissions that are back in your own system versus somewhere
else. This is provided the HSR as well.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/hsr_discharges.html">hsr_discharges</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="va">my_report</span>,</span>
<span>  cohort <span class="op">=</span> <span class="st">"HF"</span>,</span>
<span>  eligible_only <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span></span>
<span>  <span class="co"># Keep diagnosis columns</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"Same Hospital"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  </span>
<span>  <span class="co"># Make a table</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span>useNA <span class="op">=</span> <span class="st">"ifany"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Readmission to Same Hospital (Yes/No)</span></span>
<span><span class="co">#&gt;   No  Yes &lt;NA&gt; </span></span>
<span><span class="co">#&gt;    2    1   22</span></span></code></pre></div>
<p>For example, of the 22 HF discharges, three (3) were readmitted: one
(1) to the same hospital as the index stay, and two (2) elsewhere (maybe
within your system, or not).</p>
<div class="section level4">
<h4 id="benchmarking-with-other-hospitals">Benchmarking With Other Hospitals<a class="anchor" aria-label="anchor" href="#benchmarking-with-other-hospitals"></a>
</h4>
<p>CMS provides access to hospital-level performance data on <a href="https://data.cms.gov/provider-data/" class="external-link">QualityNet</a>. You can use
the <code>pdc_*</code> functions in this package to explore and import
various data files to perform comparative analyses at the hospital level
(see <code><a href="../reference/pdc_read.html">pdc_read()</a></code>).</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alex Zajichek.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
